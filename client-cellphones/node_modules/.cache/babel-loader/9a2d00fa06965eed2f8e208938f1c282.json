{"ast":null,"code":"import _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\nimport _extends from '@babel/runtime/helpers/esm/extends';\nimport * as THREE from 'three';\nimport * as React from 'react';\nimport create from 'zustand';\nimport shallow from 'zustand/shallow';\nimport _construct from '@babel/runtime/helpers/esm/construct';\nimport Reconciler from 'react-reconciler';\nimport { unstable_now, unstable_runWithPriority, unstable_IdlePriority } from 'scheduler';\nimport _createForOfIteratorHelperLoose from '@babel/runtime/helpers/esm/createForOfIteratorHelperLoose';\nimport { useAsset } from 'use-asset';\nimport _inheritsLoose from '@babel/runtime/helpers/esm/inheritsLoose';\nimport mergeRefs from 'react-merge-refs';\nimport useMeasure from 'react-use-measure';\nvar threeTypes = /*#__PURE__*/Object.freeze({\n  __proto__: null\n});\nvar is = {\n  obj: function obj(a) {\n    return a === Object(a) && !is.arr(a) && typeof a !== 'function';\n  },\n  fun: function fun(a) {\n    return typeof a === 'function';\n  },\n  str: function str(a) {\n    return typeof a === 'string';\n  },\n  num: function num(a) {\n    return typeof a === 'number';\n  },\n  und: function und(a) {\n    return a === void 0;\n  },\n  arr: function arr(a) {\n    return Array.isArray(a);\n  },\n  equ: function equ(a, b) {\n    // Wrong type or one of the two undefined, doesn't match\n    if (typeof a !== typeof b || !!a !== !!b) return false; // Atomic, just compare a against b\n\n    if (is.str(a) || is.num(a) || is.obj(a)) return a === b; // Array, shallow compare first to see if it's a match\n\n    if (is.arr(a) && a == b) return true; // Last resort, go through keys\n\n    var i;\n    for (i in a) {\n      if (!(i in b)) return false;\n    }\n    for (i in b) {\n      if (a[i] !== b[i]) return false;\n    }\n    return is.und(i) ? a === b : true;\n  }\n};\nfunction makeId(event) {\n  return (event.eventObject || event.object).uuid + '/' + event.index;\n}\nfunction removeInteractivity(store, object) {\n  var _store$getState = store.getState(),\n    internal = _store$getState.internal; // Removes every trace of an object from the data store\n\n  internal.interaction = internal.interaction.filter(function (o) {\n    return o !== object;\n  });\n  internal.initialHits = internal.initialHits.filter(function (o) {\n    return o !== object;\n  });\n  internal.hovered.forEach(function (value, key) {\n    if (value.eventObject === object || value.object === object) {\n      internal.hovered.delete(key);\n    }\n  });\n}\nfunction createEvents(store) {\n  var temp = new THREE.Vector3();\n  /** Sets up defaultRaycaster */\n\n  function prepareRay(event) {\n    var _raycaster$computeOff;\n    var state = store.getState();\n    var raycaster = state.raycaster,\n      mouse = state.mouse,\n      camera = state.camera,\n      size = state.size; // https://github.com/pmndrs/react-three-fiber/pull/782\n    // Events trigger outside of canvas when moved\n\n    var _ref = (_raycaster$computeOff = raycaster.computeOffsets == null ? void 0 : raycaster.computeOffsets(event, state)) != null ? _raycaster$computeOff : event,\n      offsetX = _ref.offsetX,\n      offsetY = _ref.offsetY;\n    var width = size.width,\n      height = size.height;\n    mouse.set(offsetX / width * 2 - 1, -(offsetY / height) * 2 + 1);\n    raycaster.setFromCamera(mouse, camera);\n  }\n  /** Calculates delta */\n\n  function calculateDistance(event) {\n    var _store$getState2 = store.getState(),\n      internal = _store$getState2.internal;\n    var dx = event.offsetX - internal.initialClick[0];\n    var dy = event.offsetY - internal.initialClick[1];\n    return Math.round(Math.sqrt(dx * dx + dy * dy));\n  }\n  /** Returns true if an instance has a valid pointer-event registered, this excludes scroll, clicks etc */\n\n  function filterPointerEvents(objects) {\n    return objects.filter(function (obj) {\n      return ['Move', 'Over', 'Enter', 'Out', 'Leave'].some(function (name) {\n        var _r3f$handlers;\n        return (_r3f$handlers = obj.__r3f.handlers) == null ? void 0 : _r3f$handlers['onPointer' + name];\n      });\n    });\n  }\n  function intersect(filter) {\n    var state = store.getState();\n    var raycaster = state.raycaster,\n      internal = state.internal; // Skip event handling when noEvents is set\n\n    if (!raycaster.enabled) return [];\n    var seen = new Set();\n    var intersections = []; // Allow callers to eliminate event objects\n\n    var eventsObjects = filter ? filter(internal.interaction) : internal.interaction; // Intersect known handler objects and filter against duplicates\n\n    var intersects = raycaster.intersectObjects(eventsObjects, true).filter(function (item) {\n      var id = makeId(item);\n      if (seen.has(id)) return false;\n      seen.add(id);\n      return true;\n    }); // https://github.com/mrdoob/three.js/issues/16031\n    // Allow custom userland intersect sort order\n\n    if (raycaster.filter) intersects = raycaster.filter(intersects, state);\n    for (var _iterator = _createForOfIteratorHelperLoose(intersects), _step; !(_step = _iterator()).done;) {\n      var _intersect = _step.value;\n      var eventObject = _intersect.object; // Bubble event up\n\n      while (eventObject) {\n        var _r3f;\n        var handlers = (_r3f = eventObject.__r3f) == null ? void 0 : _r3f.handlers;\n        if (handlers) intersections.push(_extends({}, _intersect, {\n          eventObject: eventObject\n        }));\n        eventObject = eventObject.parent;\n      }\n    }\n    return intersections;\n  }\n  /**  Creates filtered intersects and returns an array of positive hits */\n\n  function patchIntersects(intersections, event) {\n    var _store$getState3 = store.getState(),\n      internal = _store$getState3.internal; // If the interaction is captured, make all capturing targets  part of the\n    // intersect.\n\n    if ('pointerId' in event && internal.capturedMap.has(event.pointerId)) {\n      intersections.push.apply(intersections, internal.capturedMap.get(event.pointerId).values());\n    }\n    return intersections;\n  }\n  /**  Handles intersections by forwarding them to handlers */\n\n  function handleIntersects(intersections, event, callback) {\n    var _store$getState4 = store.getState(),\n      raycaster = _store$getState4.raycaster,\n      mouse = _store$getState4.mouse,\n      camera = _store$getState4.camera,\n      internal = _store$getState4.internal; // If anything has been found, forward it to the event listeners\n\n    if (intersections.length) {\n      (function () {\n        var unprojectedPoint = temp.set(mouse.x, mouse.y, 0).unproject(camera);\n        var delta = event.type === 'click' ? calculateDistance(event) : 0;\n        var releasePointerCapture = function releasePointerCapture(id) {\n          return event.target.releasePointerCapture(id);\n        };\n        var localState = {\n          stopped: false\n        };\n        var _loop = function _loop() {\n          var hit = _step2.value;\n          var hasPointerCapture = function hasPointerCapture(id) {\n            var _internal$capturedMap, _internal$capturedMap2;\n            return (_internal$capturedMap = (_internal$capturedMap2 = internal.capturedMap.get(id)) == null ? void 0 : _internal$capturedMap2.has(hit.eventObject)) != null ? _internal$capturedMap : false;\n          };\n          var setPointerCapture = function setPointerCapture(id) {\n            if (internal.capturedMap.has(id)) {\n              // if the pointerId was previously captured, we add the hit to the\n              // event capturedMap.\n              internal.capturedMap.get(id).set(hit.eventObject, hit);\n            } else {\n              // if the pointerId was not previously captured, we create a map\n              // containing the hitObject, and the hit. hitObject is used for\n              // faster access.\n              internal.capturedMap.set(id, new Map([[hit.eventObject, hit]]));\n            } // Call the original event now\n            event.target.setPointerCapture(id);\n          }; // Add native event props\n\n          var extractEventProps = {};\n          for (var prop in Object.getPrototypeOf(event)) {\n            var property = event[prop]; // Only copy over atomics, leave functions alone as these should be\n            // called as event.nativeEvent.fn()\n\n            if (typeof property !== 'function') extractEventProps[prop] = property;\n          }\n          var raycastEvent = _extends({}, hit, extractEventProps, {\n            spaceX: mouse.x,\n            spaceY: mouse.y,\n            intersections: intersections,\n            stopped: localState.stopped,\n            delta: delta,\n            unprojectedPoint: unprojectedPoint,\n            ray: raycaster.ray,\n            camera: camera,\n            // Hijack stopPropagation, which just sets a flag\n            stopPropagation: function stopPropagation() {\n              // https://github.com/pmndrs/react-three-fiber/issues/596\n              // Events are not allowed to stop propagation if the pointer has been captured\n              var capturesForPointer = 'pointerId' in event && internal.capturedMap.get(event.pointerId); // We only authorize stopPropagation...\n\n              if (\n              // ...if this pointer hasn't been captured\n              !capturesForPointer ||\n              // ... or if the hit object is capturing the pointer\n              capturesForPointer.has(hit.eventObject)) {\n                raycastEvent.stopped = localState.stopped = true; // Propagation is stopped, remove all other hover records\n                // An event handler is only allowed to flush other handlers if it is hovered itself\n\n                if (internal.hovered.size && Array.from(internal.hovered.values()).find(function (i) {\n                  return i.eventObject === hit.eventObject;\n                })) {\n                  // Objects cannot flush out higher up objects that have already caught the event\n                  var higher = intersections.slice(0, intersections.indexOf(hit));\n                  cancelPointer([].concat(higher, [hit]));\n                }\n              }\n            },\n            // there should be a distinction between target and currentTarget\n            target: {\n              hasPointerCapture: hasPointerCapture,\n              setPointerCapture: setPointerCapture,\n              releasePointerCapture: releasePointerCapture\n            },\n            currentTarget: {\n              hasPointerCapture: hasPointerCapture,\n              setPointerCapture: setPointerCapture,\n              releasePointerCapture: releasePointerCapture\n            },\n            sourceEvent: event,\n            // deprecated\n            nativeEvent: event\n          }); // Call subscribers\n\n          callback(raycastEvent); // Event bubbling may be interrupted by stopPropagation\n\n          if (localState.stopped === true) return \"break\";\n        };\n        for (var _iterator2 = _createForOfIteratorHelperLoose(intersections), _step2; !(_step2 = _iterator2()).done;) {\n          var _ret = _loop();\n          if (_ret === \"break\") break;\n        }\n      })();\n    }\n    return intersections;\n  }\n  function cancelPointer(hits) {\n    var _store$getState5 = store.getState(),\n      internal = _store$getState5.internal;\n    Array.from(internal.hovered.values()).forEach(function (hoveredObj) {\n      // When no objects were hit or the the hovered object wasn't found underneath the cursor\n      // we call onPointerOut and delete the object from the hovered-elements map\n      if (!hits.length || !hits.find(function (hit) {\n        return hit.object === hoveredObj.object && hit.index === hoveredObj.index;\n      })) {\n        var eventObject = hoveredObj.eventObject;\n        var handlers = eventObject.__r3f.handlers;\n        internal.hovered.delete(makeId(hoveredObj));\n        if (handlers) {\n          // Clear out intersects, they are outdated by now\n          var data = _extends({}, hoveredObj, {\n            intersections: hits || []\n          });\n          handlers.onPointerOut == null ? void 0 : handlers.onPointerOut(data);\n          handlers.onPointerLeave == null ? void 0 : handlers.onPointerLeave(data);\n        }\n      }\n    });\n  }\n  var handlePointer = function handlePointer(name) {\n    // Deal with cancelation\n    switch (name) {\n      case 'onPointerLeave':\n      case 'onPointerCancel':\n        return function () {\n          return cancelPointer([]);\n        };\n      case 'onLostPointerCapture':\n        return function (event) {\n          if ('pointerId' in event) {\n            // this will be a problem if one target releases the pointerId\n            // and another one is still keeping it, as the line below\n            // indifferently deletes all capturing references.\n            store.getState().internal.capturedMap.delete(event.pointerId);\n          }\n          cancelPointer([]);\n        };\n    } // Any other pointer goes here ...\n\n    return function (event) {\n      var _store$getState6 = store.getState(),\n        onPointerMissed = _store$getState6.onPointerMissed,\n        internal = _store$getState6.internal;\n      prepareRay(event); // Get fresh intersects\n\n      var isPointerMove = name === 'onPointerMove';\n      var filter = isPointerMove ? filterPointerEvents : undefined;\n      var hits = patchIntersects(intersect(filter), event); // Take care of unhover\n\n      if (isPointerMove) cancelPointer(hits);\n      handleIntersects(hits, event, function (data) {\n        var eventObject = data.eventObject;\n        var handlers = eventObject.__r3f.handlers; // Check presence of handlers\n\n        if (!handlers) return;\n        if (isPointerMove) {\n          // Move event ...\n          if (handlers.onPointerOver || handlers.onPointerEnter || handlers.onPointerOut || handlers.onPointerLeave) {\n            // When enter or out is present take care of hover-state\n            var id = makeId(data);\n            var hoveredItem = internal.hovered.get(id);\n            if (!hoveredItem) {\n              // If the object wasn't previously hovered, book it and call its handler\n              internal.hovered.set(id, data);\n              handlers.onPointerOver == null ? void 0 : handlers.onPointerOver(data);\n              handlers.onPointerEnter == null ? void 0 : handlers.onPointerEnter(data);\n            } else if (hoveredItem.stopped) {\n              // If the object was previously hovered and stopped, we shouldn't allow other items to proceed\n              data.stopPropagation();\n            }\n          } // Call mouse move\n\n          handlers.onPointerMove == null ? void 0 : handlers.onPointerMove(data);\n        } else {\n          // All other events ...\n          var handler = handlers == null ? void 0 : handlers[name];\n          if (handler) {\n            // Forward all events back to their respective handlers with the exception of click events,\n            // which must use the initial target\n            if (name !== 'onClick' && name !== 'onContextMenu' && name !== 'onDoubleClick' || internal.initialHits.includes(eventObject)) {\n              handler(data);\n              pointerMissed(event, internal.interaction.filter(function (object) {\n                return object !== eventObject;\n              }));\n            }\n          }\n        }\n      }); // Save initial coordinates on pointer-down\n\n      if (name === 'onPointerDown') {\n        internal.initialClick = [event.offsetX, event.offsetY];\n        internal.initialHits = hits.map(function (hit) {\n          return hit.eventObject;\n        });\n      } // If a click yields no results, pass it back to the user as a miss\n\n      if ((name === 'onClick' || name === 'onContextMenu' || name === 'onDoubleClick') && !hits.length) {\n        if (calculateDistance(event) <= 2) {\n          pointerMissed(event, internal.interaction);\n          if (onPointerMissed) onPointerMissed(event);\n        }\n      }\n    };\n  };\n  function pointerMissed(event, objects) {\n    objects.forEach(function (object) {\n      var _r3f$handlers2;\n      return (_r3f$handlers2 = object.__r3f.handlers) == null ? void 0 : _r3f$handlers2.onPointerMissed == null ? void 0 : _r3f$handlers2.onPointerMissed(event);\n    });\n  }\n  return {\n    handlePointer: handlePointer\n  };\n}\nvar _excluded$3 = [\"args\"],\n  _excluded2 = [\"args\"],\n  _excluded3 = [\"args\"];\n\n// Type guard to tell a store from a portal\nvar isStore = function isStore(def) {\n  return def && !!def.getState;\n};\nvar getContainer = function getContainer(container, child) {\n  var _container$__r3f$root, _container$__r3f;\n  return {\n    // If the container is not a root-store then it must be a THREE.Object3D into which part of the\n    // scene is portalled into. Now there can be two variants of this, either that object is part of\n    // the regular jsx tree, in which case it already has __r3f with a valid root attached, or it lies\n    // outside react, in which case we must take the root of the child that is about to be attached to it.\n    root: isStore(container) ? container : (_container$__r3f$root = (_container$__r3f = container.__r3f) == null ? void 0 : _container$__r3f.root) != null ? _container$__r3f$root : child.__r3f.root,\n    // The container is the eventual target into which objects are mounted, it has to be a THREE.Object3D\n    container: isStore(container) ? container.getState().scene : container\n  };\n};\nvar DEFAULT = '__default';\nvar EMPTY = {};\nvar FILTER = ['children', 'key', 'ref'];\nvar catalogue = {};\nvar extend = function extend(objects) {\n  return void (catalogue = _extends({}, catalogue, objects));\n}; // Each object in the scene carries a small LocalState descriptor\n\nfunction prepare(object, state) {\n  var instance = object;\n  if (state != null && state.instance || !instance.__r3f) {\n    instance.__r3f = _extends({\n      root: null,\n      memoizedProps: {},\n      objects: []\n    }, state);\n  }\n  return object;\n}\nfunction createRenderer(roots) {\n  function applyProps(instance, newProps, oldProps, accumulative) {\n    var _instance$__r3f, _root$getState, _instance$__r3f2;\n    if (oldProps === void 0) {\n      oldProps = {};\n    }\n    if (accumulative === void 0) {\n      accumulative = false;\n    }\n\n    // Filter equals, events and reserved props\n    var localState = (_instance$__r3f = instance == null ? void 0 : instance.__r3f) != null ? _instance$__r3f : {};\n    var root = localState.root;\n    var rootState = (_root$getState = root == null ? void 0 : root.getState == null ? void 0 : root.getState()) != null ? _root$getState : {};\n    var sameProps = [];\n    var handlers = [];\n    var newMemoizedProps = {};\n    var i = 0;\n    Object.entries(newProps).forEach(function (_ref) {\n      var key = _ref[0],\n        entry = _ref[1];\n\n      // we don't want children, ref or key in the memoized props\n      if (FILTER.indexOf(key) === -1) {\n        newMemoizedProps[key] = entry;\n      }\n    });\n    if (localState.memoizedProps && localState.memoizedProps.args) {\n      newMemoizedProps.args = localState.memoizedProps.args;\n    }\n    if (localState.memoizedProps && localState.memoizedProps.attach) {\n      newMemoizedProps.attach = localState.memoizedProps.attach;\n    }\n    if (instance.__r3f) {\n      instance.__r3f.memoizedProps = newMemoizedProps;\n    }\n    var objectKeys = Object.keys(newProps);\n    for (i = 0; i < objectKeys.length; i++) {\n      if (is.equ(newProps[objectKeys[i]], oldProps[objectKeys[i]])) {\n        sameProps.push(objectKeys[i]);\n      } // Event-handlers ...\n      //   are functions, that\n      //   start with \"on\", and\n      //   contain the name \"Pointer\", \"Click\", \"DoubleClick\", \"ContextMenu\", or \"Wheel\"\n\n      if (is.fun(newProps[objectKeys[i]]) && /^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(objectKeys[i])) {\n        handlers.push(objectKeys[i]);\n      }\n    } // Catch props that existed, but now exist no more ...\n\n    var leftOvers = [];\n    if (accumulative) {\n      objectKeys = Object.keys(oldProps);\n      for (i = 0; i < objectKeys.length; i++) {\n        if (!newProps.hasOwnProperty(objectKeys[i])) {\n          leftOvers.push(objectKeys[i]);\n        }\n      }\n    }\n    var toFilter = [].concat(sameProps, FILTER); // Instances use \"object\" as a reserved identifier\n\n    if ((_instance$__r3f2 = instance.__r3f) != null && _instance$__r3f2.instance) toFilter.push('object');\n    var filteredProps = _extends({}, newProps); // Removes sameProps and reserved props from newProps\n\n    objectKeys = Object.keys(filteredProps);\n    for (i = 0; i < objectKeys.length; i++) {\n      if (toFilter.indexOf(objectKeys[i]) > -1) {\n        delete filteredProps[objectKeys[i]];\n      }\n    } // Collect all new props\n\n    var filteredPropsEntries = Object.entries(filteredProps); // Prepend left-overs so they can be reset or removed\n    // Left-overs must come first!\n\n    for (i = 0; i < leftOvers.length; i++) {\n      if (leftOvers[i] !== 'children') {\n        filteredPropsEntries.unshift([leftOvers[i], DEFAULT + 'remove']);\n      }\n    }\n    if (filteredPropsEntries.length > 0) {\n      filteredPropsEntries.forEach(function (_ref2) {\n        var key = _ref2[0],\n          value = _ref2[1];\n        if (!handlers.includes(key)) {\n          var currentInstance = instance;\n          var targetProp = currentInstance[key];\n          if (key.includes('-')) {\n            var entries = key.split('-');\n            targetProp = entries.reduce(function (acc, key) {\n              return acc[key];\n            }, instance); // If the target is atomic, it forces us to switch the root\n\n            if (!(targetProp && targetProp.set)) {\n              var _entries$reverse = entries.reverse(),\n                _name = _entries$reverse[0],\n                reverseEntries = _entries$reverse.slice(1);\n              currentInstance = reverseEntries.reverse().reduce(function (acc, key) {\n                return acc[key];\n              }, instance);\n              key = _name;\n            }\n          } // https://github.com/mrdoob/three.js/issues/21209\n          // HMR/fast-refresh relies on the ability to cancel out props, but threejs\n          // has no means to do this. Hence we curate a small collection of value-classes\n          // with their respective constructor/set arguments\n          // For removed props, try to set default values, if possible\n\n          if (value === DEFAULT + 'remove') {\n            if (targetProp && targetProp.constructor) {\n              // use the prop constructor to find the default it should be\n              value = new targetProp.constructor(newMemoizedProps.args);\n            } else if (currentInstance.constructor) {\n              // create a blank slate of the instance and copy the particular parameter.\n              // @ts-ignore\n              var defaultClassCall = new currentInstance.constructor(currentInstance.__r3f.memoizedProps.args);\n              value = defaultClassCall[targetProp]; // destory the instance\n\n              if (defaultClassCall.dispose) {\n                defaultClassCall.dispose();\n              }\n            } else {\n              // instance does not have constructor, just set it to 0\n              value = 0;\n            }\n          } // Special treatment for objects with support for set/copy, and layers\n\n          if (targetProp && targetProp.set && (targetProp.copy || targetProp instanceof THREE.Layers)) {\n            // If value is an array\n            if (Array.isArray(value)) {\n              if (targetProp.fromArray) {\n                targetProp.fromArray(value);\n              } else {\n                var _targetProp;\n                (_targetProp = targetProp).set.apply(_targetProp, value);\n              }\n            } // Test again target.copy(class) next ...\n            else if (targetProp.copy && value && value.constructor && targetProp.constructor.name === value.constructor.name) {\n              targetProp.copy(value);\n            } // If nothing else fits, just set the single value, ignore undefined\n            // https://github.com/react-spring/react-three-fiber/issues/274\n            else if (value !== undefined) {\n              var isColor = targetProp instanceof THREE.Color; // Allow setting array scalars\n\n              if (!isColor && targetProp.setScalar) targetProp.setScalar(value); // Layers have no copy function, we must therefore copy the mask property\n              else if (targetProp instanceof THREE.Layers && value instanceof THREE.Layers) targetProp.mask = value.mask; // Otherwise just set ...\n              else targetProp.set(value); // Auto-convert sRGB colors, for now ...\n              // https://github.com/react-spring/react-three-fiber/issues/344\n\n              if (!rootState.linear && isColor) targetProp.convertSRGBToLinear();\n            } // Else, just overwrite the value\n          } else {\n            currentInstance[key] = value; // Auto-convert sRGB textures, for now ...\n            // https://github.com/react-spring/react-three-fiber/issues/344\n\n            if (!rootState.linear && currentInstance[key] instanceof THREE.Texture) currentInstance[key].encoding = THREE.sRGBEncoding;\n          }\n          invalidateInstance(instance);\n        }\n      }); // Preemptively delete the instance from the containers interaction\n\n      if (accumulative && root && instance.raycast && localState.handlers) {\n        localState.handlers = undefined;\n        var index = rootState.internal.interaction.indexOf(instance);\n        if (index > -1) rootState.internal.interaction.splice(index, 1);\n      } // Prep interaction handlers\n\n      if (handlers.length) {\n        if (accumulative && root && instance.raycast) {\n          rootState.internal.interaction.push(instance);\n        } // Add handlers to the instances handler-map\n\n        localState.handlers = handlers.reduce(function (acc, key) {\n          var _extends2;\n          return _extends({}, acc, (_extends2 = {}, _extends2[key] = newProps[key], _extends2));\n        }, {});\n      } // Call the update lifecycle when it is being updated, but only when it is part of the scene\n\n      if (instance.parent) updateInstance(instance);\n    }\n  }\n  function invalidateInstance(instance) {\n    var _instance$__r3f3, _instance$__r3f3$root;\n    var state = (_instance$__r3f3 = instance.__r3f) == null ? void 0 : (_instance$__r3f3$root = _instance$__r3f3.root) == null ? void 0 : _instance$__r3f3$root.getState == null ? void 0 : _instance$__r3f3$root.getState();\n    if (state && state.internal.frames === 0) state.invalidate();\n  }\n  function updateInstance(instance) {\n    instance.onUpdate == null ? void 0 : instance.onUpdate(instance);\n  }\n  function createInstance(type, _ref3, root, hostContext, internalInstanceHandle) {\n    var _ref3$args = _ref3.args,\n      args = _ref3$args === void 0 ? [] : _ref3$args,\n      props = _objectWithoutPropertiesLoose(_ref3, _excluded$3);\n    var name = \"\" + type[0].toUpperCase() + type.slice(1);\n    var instance; // https://github.com/facebook/react/issues/17147\n    // Portals do not give us a root, they are themselves treated as a root by the reconciler\n    // In order to figure out the actual root we have to climb through fiber internals :(\n\n    if (!isStore(root) && internalInstanceHandle) {\n      var fn = function fn(node) {\n        if (!node.return) return node.stateNode && node.stateNode.containerInfo;else return fn(node.return);\n      };\n      root = fn(internalInstanceHandle);\n    } // Assert that by now we have a valid root\n\n    if (!root || !isStore(root)) throw \"No valid root for \" + name + \"!\";\n    if (type === 'primitive') {\n      if (props.object === undefined) throw \"Primitives without 'object' are invalid!\";\n      var object = props.object;\n      instance = prepare(object, {\n        root: root,\n        instance: true\n      });\n    } else {\n      var target = catalogue[name] || THREE[name];\n      if (!target) throw name + \" is not part of the THREE namespace! Did you forget to extend? See: https://github.com/pmndrs/react-three-fiber/blob/master/markdown/api.md#using-3rd-party-objects-declaratively\";\n      var isArgsArr = is.arr(args); // Instanciate new object, link it to the root\n\n      instance = prepare(isArgsArr ? _construct(target, args) : new target(args), {\n        root: root,\n        // append memoized props with args so it's not forgotten\n        memoizedProps: {\n          args: isArgsArr && args.length === 0 ? null : args\n        }\n      });\n    } // Auto-attach geometries and materials\n\n    if (!('attachFns' in props)) {\n      if (name.endsWith('Geometry')) {\n        props = _extends({\n          attach: 'geometry'\n        }, props);\n      } else if (name.endsWith('Material')) {\n        props = _extends({\n          attach: 'material'\n        }, props);\n      }\n    } // It should NOT call onUpdate on object instanciation, because it hasn't been added to the\n    // view yet. If the callback relies on references for instance, they won't be ready yet, this is\n    // why it passes \"true\" here\n\n    applyProps(instance, props, {});\n    return instance;\n  }\n  function appendChild(parentInstance, child) {\n    var addedAsChild = false;\n    if (child) {\n      // The attach attribute implies that the object attaches itself on the parent\n      if (child.attachArray) {\n        if (!is.arr(parentInstance[child.attachArray])) parentInstance[child.attachArray] = [];\n        parentInstance[child.attachArray].push(child);\n      } else if (child.attachObject) {\n        if (!is.obj(parentInstance[child.attachObject[0]])) parentInstance[child.attachObject[0]] = {};\n        parentInstance[child.attachObject[0]][child.attachObject[1]] = child;\n      } else if (child.attach && !is.fun(child.attach)) {\n        parentInstance[child.attach] = child;\n      } else if (is.arr(child.attachFns)) {\n        var _ref4 = child.attachFns,\n          attachFn = _ref4[0];\n        if (is.str(attachFn) && is.fun(parentInstance[attachFn])) {\n          parentInstance[attachFn](child);\n        } else if (is.fun(attachFn)) {\n          attachFn(child, parentInstance);\n        }\n      } else if (child.isObject3D) {\n        // add in the usual parent-child way\n        parentInstance.add(child);\n        addedAsChild = true;\n      }\n      if (!addedAsChild) {\n        // This is for anything that used attach, and for non-Object3Ds that don't get attached to props;\n        // that is, anything that's a child in React but not a child in the scenegraph.\n        parentInstance.__r3f.objects.push(child);\n        child.parent = parentInstance;\n      }\n      updateInstance(child);\n      invalidateInstance(child);\n    }\n  }\n  function insertBefore(parentInstance, child, beforeChild) {\n    var added = false;\n    if (child) {\n      if (child.attachArray) {\n        var array = parentInstance[child.attachArray];\n        if (!is.arr(array)) parentInstance[child.attachArray] = [];\n        array.splice(array.indexOf(beforeChild), 0, child);\n      } else if (child.attachObject || child.attach && !is.fun(child.attach)) {\n        // attach and attachObject don't have an order anyway, so just append\n        return appendChild(parentInstance, child);\n      } else if (child.isObject3D) {\n        child.parent = parentInstance;\n        child.dispatchEvent({\n          type: 'added'\n        });\n        var restSiblings = parentInstance.children.filter(function (sibling) {\n          return sibling !== child;\n        });\n        var index = restSiblings.indexOf(beforeChild);\n        parentInstance.children = [].concat(restSiblings.slice(0, index), [child], restSiblings.slice(index));\n        added = true;\n      }\n      if (!added) {\n        parentInstance.__r3f.objects.push(child);\n        child.parent = parentInstance;\n      }\n      updateInstance(child);\n      invalidateInstance(child);\n    }\n  }\n  function removeRecursive(array, parent, dispose) {\n    if (dispose === void 0) {\n      dispose = false;\n    }\n    if (array) [].concat(array).forEach(function (child) {\n      return removeChild(parent, child, dispose);\n    });\n  }\n  function removeChild(parentInstance, child, dispose) {\n    if (child) {\n      var _child$__r3f2;\n      if (parentInstance.__r3f.objects) {\n        var oldLength = parentInstance.__r3f.objects.length;\n        parentInstance.__r3f.objects = parentInstance.__r3f.objects.filter(function (x) {\n          return x !== child;\n        });\n        var newLength = parentInstance.__r3f.objects.length; // was it in the list?\n\n        if (newLength < oldLength) {\n          // we had also set this, so we must clear it now\n          child.parent = null;\n        }\n      } // Remove attachment\n\n      if (child.attachArray) {\n        parentInstance[child.attachArray] = parentInstance[child.attachArray].filter(function (x) {\n          return x !== child;\n        });\n      } else if (child.attachObject) {\n        delete parentInstance[child.attachObject[0]][child.attachObject[1]];\n      } else if (child.attach && !is.fun(child.attach)) {\n        parentInstance[child.attach] = null;\n      } else if (is.arr(child.attachFns)) {\n        var _ref5 = child.attachFns,\n          detachFn = _ref5[1];\n        if (is.str(detachFn) && is.fun(parentInstance[detachFn])) {\n          parentInstance[detachFn](child);\n        } else if (is.fun(detachFn)) {\n          detachFn(child, parentInstance);\n        }\n      } else if (child.isObject3D) {\n        var _child$__r3f;\n        parentInstance.remove(child); // Remove interactivity\n\n        if ((_child$__r3f = child.__r3f) != null && _child$__r3f.root) {\n          removeInteractivity(child.__r3f.root, child);\n        }\n      } // Allow objects to bail out of recursive dispose alltogether by passing dispose={null}\n      // Never dispose of primitives because their state may be kept outside of React!\n      // In order for an object to be able to dispose it has to have\n      //   - a dispose method,\n      //   - it cannot be an <instance object={...} />\n      //   - it cannot be a THREE.Scene, because three has broken it's own api\n      //\n      // Since disposal is recursive, we can check the optional dispose arg, which will be undefined\n      // when the reconciler calls it, but then carry our own check recursively\n\n      var isInstance = (_child$__r3f2 = child.__r3f) == null ? void 0 : _child$__r3f2.instance;\n      var shouldDispose = dispose === undefined ? child.dispose !== null && !isInstance : dispose; // Remove nested child objects. Primitives should not have objects and children that are\n      // attached to them declaratively ...\n\n      if (!isInstance) {\n        var _child$__r3f3;\n        removeRecursive((_child$__r3f3 = child.__r3f) == null ? void 0 : _child$__r3f3.objects, child, shouldDispose);\n        removeRecursive(child.children, child, shouldDispose);\n      } // Remove references\n\n      if (child.__r3f) {\n        delete child.__r3f.root;\n        delete child.__r3f.objects;\n        delete child.__r3f.handlers;\n        delete child.__r3f.memoizedProps;\n        if (!isInstance) delete child.__r3f;\n      } // Dispose item whenever the reconciler feels like it\n\n      if (shouldDispose && child.dispose && child.type !== 'Scene') {\n        unstable_runWithPriority(unstable_IdlePriority, function () {\n          return child.dispose();\n        });\n      }\n      invalidateInstance(parentInstance);\n    }\n  }\n  function switchInstance(instance, type, newProps, fiber) {\n    var parent = instance.parent;\n    if (!parent) return;\n    var newInstance = createInstance(type, newProps, instance.__r3f.root); // https://github.com/pmndrs/react-three-fiber/issues/1348\n    // When args change the instance has to be re-constructed, which then\n    // forces r3f to re-parent the children and non-scene objects\n\n    if (instance.children) {\n      instance.children.forEach(function (child) {\n        return appendChild(newInstance, child);\n      });\n      instance.children = [];\n    }\n    instance.__r3f.objects.forEach(function (child) {\n      return appendChild(newInstance, child);\n    });\n    instance.__r3f.objects = [];\n    removeChild(parent, instance);\n    appendChild(parent, newInstance) // This evil hack switches the react-internal fiber node\n    // https://github.com/facebook/react/issues/14983\n    // https://github.com/facebook/react/pull/15021\n    ;\n    [fiber, fiber.alternate].forEach(function (fiber) {\n      if (fiber !== null) {\n        fiber.stateNode = newInstance;\n        if (fiber.ref) {\n          if (typeof fiber.ref === 'function') fiber.ref(newInstance);else fiber.ref.current = newInstance;\n        }\n      }\n    });\n  }\n  var reconciler = Reconciler({\n    now: unstable_now,\n    createInstance: createInstance,\n    removeChild: removeChild,\n    appendChild: appendChild,\n    appendInitialChild: appendChild,\n    insertBefore: insertBefore,\n    warnsIfNotActing: true,\n    supportsMutation: true,\n    isPrimaryRenderer: false,\n    // @ts-ignore\n    scheduleTimeout: is.fun(setTimeout) ? setTimeout : undefined,\n    // @ts-ignore\n    cancelTimeout: is.fun(clearTimeout) ? clearTimeout : undefined,\n    // @ts-ignore\n    setTimeout: is.fun(setTimeout) ? setTimeout : undefined,\n    // @ts-ignore\n    clearTimeout: is.fun(clearTimeout) ? clearTimeout : undefined,\n    noTimeout: -1,\n    appendChildToContainer: function appendChildToContainer(parentInstance, child) {\n      var _getContainer = getContainer(parentInstance, child),\n        container = _getContainer.container,\n        root = _getContainer.root; // Link current root to the default scene\n\n      container.__r3f.root = root;\n      appendChild(container, child);\n    },\n    removeChildFromContainer: function removeChildFromContainer(parentInstance, child) {\n      var _getContainer2 = getContainer(parentInstance, child),\n        container = _getContainer2.container;\n      removeChild(container, child);\n    },\n    insertInContainerBefore: function insertInContainerBefore(parentInstance, child, beforeChild) {\n      var _getContainer3 = getContainer(parentInstance, child),\n        container = _getContainer3.container;\n      insertBefore(container, child, beforeChild);\n    },\n    commitUpdate: function commitUpdate(instance, updatePayload, type, oldProps, newProps, fiber) {\n      if (instance.__r3f.instance && newProps.object && newProps.object !== instance) {\n        // <instance object={...} /> where the object reference has changed\n        switchInstance(instance, type, newProps, fiber);\n      } else {\n        // This is a data object, let's extract critical information about it\n        var _newProps$args = newProps.args,\n          argsNew = _newProps$args === void 0 ? [] : _newProps$args,\n          restNew = _objectWithoutPropertiesLoose(newProps, _excluded2);\n        var _oldProps$args = oldProps.args,\n          argsOld = _oldProps$args === void 0 ? [] : _oldProps$args,\n          restOld = _objectWithoutPropertiesLoose(oldProps, _excluded3); // If it has new props or arguments, then it needs to be re-instanciated\n\n        var hasNewArgs = argsNew.some(function (value, index) {\n          return is.obj(value) ? Object.entries(value).some(function (_ref6) {\n            var key = _ref6[0],\n              val = _ref6[1];\n            return val !== argsOld[index][key];\n          }) : value !== argsOld[index];\n        });\n        if (hasNewArgs) {\n          // Next we create a new instance and append it again\n          switchInstance(instance, type, newProps, fiber);\n        } else {\n          // Otherwise just overwrite props\n          applyProps(instance, restNew, restOld, true);\n        }\n      }\n    },\n    hideInstance: function hideInstance(instance) {\n      if (instance.isObject3D) {\n        instance.visible = false;\n        invalidateInstance(instance);\n      }\n    },\n    unhideInstance: function unhideInstance(instance, props) {\n      if (instance.isObject3D && props.visible == null || props.visible) {\n        instance.visible = true;\n        invalidateInstance(instance);\n      }\n    },\n    hideTextInstance: function hideTextInstance() {\n      throw new Error('Text is not allowed in the R3F tree.');\n    },\n    getPublicInstance: function getPublicInstance(instance) {\n      // TODO: might fix switchInstance (?)\n      return instance;\n    },\n    getRootHostContext: function getRootHostContext(rootContainer) {\n      return EMPTY;\n    },\n    getChildHostContext: function getChildHostContext(parentHostContext) {\n      return EMPTY;\n    },\n    createTextInstance: function createTextInstance() {},\n    finalizeInitialChildren: function finalizeInitialChildren(instance) {\n      // https://github.com/facebook/react/issues/20271\n      // Returning true will trigger commitMount\n      return !!instance.__r3f.handlers;\n    },\n    commitMount: function commitMount(instance) /*, type, props*/\n    {\n      // https://github.com/facebook/react/issues/20271\n      // This will make sure events are only added once to the central container\n      if (instance.raycast && instance.__r3f.handlers) instance.__r3f.root.getState().internal.interaction.push(instance);\n    },\n    prepareUpdate: function prepareUpdate() {\n      return EMPTY;\n    },\n    shouldDeprioritizeSubtree: function shouldDeprioritizeSubtree() {\n      return false;\n    },\n    prepareForCommit: function prepareForCommit() {\n      return null;\n    },\n    preparePortalMount: function preparePortalMount() {// noop\n    },\n    resetAfterCommit: function resetAfterCommit() {// noop\n    },\n    shouldSetTextContent: function shouldSetTextContent() {\n      return false;\n    },\n    clearContainer: function clearContainer() {\n      return false;\n    }\n  });\n  return {\n    reconciler: reconciler,\n    applyProps: applyProps\n  };\n}\nvar _excluded$2 = [\"params\"];\nvar isRenderer = function isRenderer(def) {\n  return def && !!def.render;\n};\nvar isOrthographicCamera = function isOrthographicCamera(def) {\n  return def && def.isOrthographicCamera;\n};\nvar context = /*#__PURE__*/React.createContext(null);\nvar createStore = function createStore(applyProps, _invalidate, _advance, props) {\n  var gl = props.gl,\n    size = props.size,\n    _props$shadows = props.shadows,\n    shadows = _props$shadows === void 0 ? false : _props$shadows,\n    _props$linear = props.linear,\n    linear = _props$linear === void 0 ? false : _props$linear,\n    _props$flat = props.flat,\n    flat = _props$flat === void 0 ? false : _props$flat,\n    _props$vr = props.vr,\n    vr = _props$vr === void 0 ? false : _props$vr,\n    _props$orthographic = props.orthographic,\n    orthographic = _props$orthographic === void 0 ? false : _props$orthographic,\n    _props$frameloop = props.frameloop,\n    frameloop = _props$frameloop === void 0 ? 'always' : _props$frameloop,\n    _props$dpr = props.dpr,\n    dpr = _props$dpr === void 0 ? 1 : _props$dpr,\n    performance = props.performance,\n    _props$clock = props.clock,\n    clock = _props$clock === void 0 ? new THREE.Clock() : _props$clock,\n    raycastOptions = props.raycaster,\n    cameraOptions = props.camera,\n    onPointerMissed = props.onPointerMissed; // Set shadowmap\n\n  if (shadows) {\n    gl.shadowMap.enabled = true;\n    if (typeof shadows === 'object') Object.assign(gl.shadowMap, shadows);else gl.shadowMap.type = THREE.PCFSoftShadowMap;\n  } // Set color management\n\n  if (!linear) {\n    if (!flat) gl.toneMapping = THREE.ACESFilmicToneMapping;\n    gl.outputEncoding = THREE.sRGBEncoding;\n  } // clock.elapsedTime is updated using advance(timestamp)\n\n  if (frameloop === 'never') {\n    clock.stop();\n    clock.elapsedTime = 0;\n  }\n  var rootState = create(function (set, get) {\n    // Create custom raycaster\n    var raycaster = new THREE.Raycaster();\n    var _ref = raycastOptions || {},\n      params = _ref.params,\n      options = _objectWithoutPropertiesLoose(_ref, _excluded$2);\n    applyProps(raycaster, _extends({\n      enabled: true\n    }, options, {\n      params: _extends({}, raycaster.params, params)\n    }), {}); // Create default camera\n\n    var isCamera = cameraOptions instanceof THREE.Camera;\n    var camera = isCamera ? cameraOptions : orthographic ? new THREE.OrthographicCamera(0, 0, 0, 0, 0.1, 1000) : new THREE.PerspectiveCamera(75, 0, 0.1, 1000);\n    if (!isCamera) {\n      camera.position.z = 5;\n      if (cameraOptions) applyProps(camera, cameraOptions, {}); // Always look at center by default\n\n      camera.lookAt(0, 0, 0);\n    }\n    function _setDpr(dpr) {\n      return Array.isArray(dpr) ? Math.min(Math.max(dpr[0], window.devicePixelRatio), dpr[1]) : dpr;\n    }\n    var initialDpr = _setDpr(dpr);\n    var position = new THREE.Vector3();\n    var defaultTarget = new THREE.Vector3();\n    function getCurrentViewport(camera, target, size) {\n      if (camera === void 0) {\n        camera = get().camera;\n      }\n      if (target === void 0) {\n        target = defaultTarget;\n      }\n      if (size === void 0) {\n        size = get().size;\n      }\n      var _size = size,\n        width = _size.width,\n        height = _size.height;\n      var aspect = width / height;\n      var distance = camera.getWorldPosition(position).distanceTo(target);\n      if (isOrthographicCamera(camera)) {\n        return {\n          width: width / camera.zoom,\n          height: height / camera.zoom,\n          factor: 1,\n          distance: distance,\n          aspect: aspect\n        };\n      } else {\n        var fov = camera.fov * Math.PI / 180; // convert vertical fov to radians\n\n        var h = 2 * Math.tan(fov / 2) * distance; // visible height\n\n        var w = h * (width / height);\n        return {\n          width: w,\n          height: h,\n          factor: width / w,\n          distance: distance,\n          aspect: aspect\n        };\n      }\n    }\n    var performanceTimeout = undefined;\n    var setPerformanceCurrent = function setPerformanceCurrent(current) {\n      return set(function (state) {\n        return {\n          performance: _extends({}, state.performance, {\n            current: current\n          })\n        };\n      });\n    };\n    return {\n      gl: gl,\n      set: set,\n      get: get,\n      invalidate: function invalidate() {\n        return _invalidate(get());\n      },\n      advance: function advance(timestamp, runGlobalEffects) {\n        return _advance(timestamp, runGlobalEffects, get());\n      },\n      linear: linear,\n      flat: flat,\n      scene: prepare(new THREE.Scene()),\n      camera: camera,\n      controls: null,\n      raycaster: raycaster,\n      clock: clock,\n      mouse: new THREE.Vector2(),\n      vr: vr,\n      frameloop: frameloop,\n      onPointerMissed: onPointerMissed,\n      performance: _extends({\n        current: 1,\n        min: 0.5,\n        max: 1,\n        debounce: 200\n      }, performance, {\n        regress: function regress() {\n          var state = get(); // Clear timeout\n\n          if (performanceTimeout) clearTimeout(performanceTimeout); // Set lower bound performance\n\n          if (state.performance.current !== state.performance.min) setPerformanceCurrent(state.performance.min); // Go back to upper bound performance after a while unless something regresses meanwhile\n\n          performanceTimeout = setTimeout(function () {\n            return setPerformanceCurrent(get().performance.max);\n          }, state.performance.debounce);\n        }\n      }),\n      size: {\n        width: 0,\n        height: 0\n      },\n      viewport: {\n        initialDpr: initialDpr,\n        dpr: initialDpr,\n        width: 0,\n        height: 0,\n        aspect: 0,\n        distance: 0,\n        factor: 0,\n        getCurrentViewport: getCurrentViewport\n      },\n      setSize: function setSize(width, height) {\n        var size = {\n          width: width,\n          height: height\n        };\n        set(function (state) {\n          return {\n            size: size,\n            viewport: _extends({}, state.viewport, getCurrentViewport(camera, defaultTarget, size))\n          };\n        });\n      },\n      setDpr: function setDpr(dpr) {\n        return set(function (state) {\n          return {\n            viewport: _extends({}, state.viewport, {\n              dpr: _setDpr(dpr)\n            })\n          };\n        });\n      },\n      events: {\n        connected: false\n      },\n      internal: {\n        active: false,\n        priority: 0,\n        frames: 0,\n        lastProps: props,\n        interaction: [],\n        hovered: new Map(),\n        subscribers: [],\n        initialClick: [0, 0],\n        initialHits: [],\n        capturedMap: new Map(),\n        subscribe: function subscribe(ref, priority) {\n          if (priority === void 0) {\n            priority = 0;\n          }\n          set(function (_ref2) {\n            var internal = _ref2.internal;\n            return {\n              internal: _extends({}, internal, {\n                // If this subscription was given a priority, it takes rendering into its own hands\n                // For that reason we switch off automatic rendering and increase the manual flag\n                // As long as this flag is positive (there could be multiple render subscription)\n                // ..there can be no internal rendering at all\n                priority: internal.priority + (priority > 0 ? 1 : 0),\n                // Register subscriber and sort layers from lowest to highest, meaning,\n                // highest priority renders last (on top of the other frames)\n                subscribers: [].concat(internal.subscribers, [{\n                  ref: ref,\n                  priority: priority\n                }]).sort(function (a, b) {\n                  return a.priority - b.priority;\n                })\n              })\n            };\n          });\n          return function () {\n            set(function (_ref3) {\n              var internal = _ref3.internal;\n              return {\n                internal: _extends({}, internal, {\n                  // Decrease manual flag if this subscription had a priority\n                  priority: internal.priority - (priority > 0 ? 1 : 0),\n                  // Remove subscriber from list\n                  subscribers: internal.subscribers.filter(function (s) {\n                    return s.ref !== ref;\n                  })\n                })\n              };\n            });\n          };\n        }\n      }\n    };\n  }); // Resize camera and renderer on changes to size and pixelratio\n\n  rootState.subscribe(function () {\n    var _rootState$getState = rootState.getState(),\n      camera = _rootState$getState.camera,\n      size = _rootState$getState.size,\n      viewport = _rootState$getState.viewport,\n      internal = _rootState$getState.internal; // https://github.com/pmndrs/react-three-fiber/issues/92\n    // Do not mess with the camera if it belongs to the user\n\n    if (!(internal.lastProps.camera instanceof THREE.Camera)) {\n      if (isOrthographicCamera(camera)) {\n        camera.left = size.width / -2;\n        camera.right = size.width / 2;\n        camera.top = size.height / 2;\n        camera.bottom = size.height / -2;\n      } else {\n        camera.aspect = size.width / size.height;\n      }\n      camera.updateProjectionMatrix(); // https://github.com/pmndrs/react-three-fiber/issues/178\n      // Update matrix world since the renderer is a frame late\n\n      camera.updateMatrixWorld();\n    } // Update renderer\n\n    gl.setPixelRatio(viewport.dpr);\n    gl.setSize(size.width, size.height);\n  }, function (state) {\n    return [state.viewport.dpr, state.size];\n  }, shallow);\n  var state = rootState.getState(); // Update size\n\n  if (size) state.setSize(size.width, size.height); // Invalidate on any change\n\n  rootState.subscribe(function (state) {\n    return _invalidate(state);\n  }); // Return root state\n\n  return rootState;\n};\nfunction createSubs(callback, subs) {\n  var index = subs.length;\n  subs.push(callback);\n  return function () {\n    return void subs.splice(index, 1);\n  };\n}\nvar i;\nvar globalEffects = [];\nvar globalAfterEffects = [];\nvar globalTailEffects = [];\nvar addEffect = function addEffect(callback) {\n  return createSubs(callback, globalEffects);\n};\nvar addAfterEffect = function addAfterEffect(callback) {\n  return createSubs(callback, globalAfterEffects);\n};\nvar addTail = function addTail(callback) {\n  return createSubs(callback, globalTailEffects);\n};\nfunction run(effects, timestamp) {\n  for (i = 0; i < effects.length; i++) {\n    effects[i](timestamp);\n  }\n}\nfunction render$1(timestamp, state) {\n  // Run local effects\n  var delta = state.clock.getDelta(); // In frameloop='never' mode, clock times are updated using the provided timestamp\n\n  if (state.frameloop === 'never' && typeof timestamp === 'number') {\n    delta = timestamp - state.clock.elapsedTime;\n    state.clock.oldTime = state.clock.elapsedTime;\n    state.clock.elapsedTime = timestamp;\n  } // Call subscribers (useFrame)\n\n  for (i = 0; i < state.internal.subscribers.length; i++) {\n    state.internal.subscribers[i].ref.current(state, delta);\n  } // Render content\n\n  if (!state.internal.priority && state.gl.render) state.gl.render(state.scene, state.camera); // Decrease frame count\n\n  state.internal.frames = Math.max(0, state.internal.frames - 1);\n  return state.frameloop === 'always' ? 1 : state.internal.frames;\n}\nfunction createLoop(roots) {\n  var running = false;\n  var repeat;\n  function loop(timestamp) {\n    running = true;\n    repeat = 0; // Run effects\n\n    run(globalEffects, timestamp); // Render all roots\n\n    roots.forEach(function (root) {\n      var state = root.store.getState(); // If the frameloop is invalidated, do not run another frame\n\n      if (state.internal.active && (state.frameloop === 'always' || state.internal.frames > 0)) repeat += render$1(timestamp, state);\n    }); // Run after-effects\n\n    run(globalAfterEffects, timestamp); // Keep on looping if anything invalidates the frameloop\n\n    if (repeat > 0) return requestAnimationFrame(loop); // Tail call effects, they are called when rendering stops\n    else run(globalTailEffects, timestamp); // Flag end of operation\n\n    running = false;\n  }\n  function invalidate(state) {\n    if (!state) return roots.forEach(function (root) {\n      return invalidate(root.store.getState());\n    });\n    if (state.vr || !state.internal.active || state.frameloop === 'never') return; // Increase frames, do not go higher than 60\n\n    state.internal.frames = Math.min(60, state.internal.frames + 1); // If the render-loop isn't active, start it\n\n    if (!running) {\n      running = true;\n      requestAnimationFrame(loop);\n    }\n  }\n  function advance(timestamp, runGlobalEffects, state) {\n    if (runGlobalEffects === void 0) {\n      runGlobalEffects = true;\n    }\n    if (runGlobalEffects) run(globalEffects, timestamp);\n    if (!state) roots.forEach(function (root) {\n      return render$1(timestamp, root.store.getState());\n    });else render$1(timestamp, state);\n    if (runGlobalEffects) run(globalAfterEffects, timestamp);\n  }\n  return {\n    loop: loop,\n    invalidate: invalidate,\n    advance: advance\n  };\n}\nfunction createPointerEvents(store) {\n  var _createEvents = createEvents(store),\n    handlePointer = _createEvents.handlePointer;\n  var names = {\n    onClick: ['click', false],\n    onContextMenu: ['contextmenu', false],\n    onDoubleClick: ['dblclick', false],\n    onWheel: ['wheel', true],\n    onPointerDown: ['pointerdown', true],\n    onPointerUp: ['pointerup', true],\n    onPointerLeave: ['pointerleave', true],\n    onPointerMove: ['pointermove', true],\n    onPointerCancel: ['pointercancel', true],\n    onLostPointerCapture: ['lostpointercapture', true]\n  };\n  return {\n    connected: false,\n    handlers: Object.keys(names).reduce(function (acc, key) {\n      var _extends2;\n      return _extends({}, acc, (_extends2 = {}, _extends2[key] = handlePointer(key), _extends2));\n    }, {}),\n    connect: function connect(target) {\n      var _events$handlers;\n      var _store$getState = store.getState(),\n        set = _store$getState.set,\n        events = _store$getState.events;\n      events.disconnect == null ? void 0 : events.disconnect();\n      set(function (state) {\n        return {\n          events: _extends({}, state.events, {\n            connected: target\n          })\n        };\n      });\n      Object.entries((_events$handlers = events == null ? void 0 : events.handlers) != null ? _events$handlers : []).forEach(function (_ref) {\n        var name = _ref[0],\n          event = _ref[1];\n        var _names = names[name],\n          eventName = _names[0],\n          passive = _names[1];\n        target.addEventListener(eventName, event, {\n          passive: passive\n        });\n      });\n    },\n    disconnect: function disconnect() {\n      var _store$getState2 = store.getState(),\n        set = _store$getState2.set,\n        events = _store$getState2.events;\n      if (events.connected) {\n        var _events$handlers2;\n        Object.entries((_events$handlers2 = events.handlers) != null ? _events$handlers2 : []).forEach(function (_ref2) {\n          var name = _ref2[0],\n            event = _ref2[1];\n          if (events && events.connected instanceof HTMLElement) {\n            var _names2 = names[name],\n              eventName = _names2[0];\n            events.connected.removeEventListener(eventName, event);\n          }\n        });\n        set(function (state) {\n          return {\n            events: _extends({}, state.events, {\n              connected: false\n            })\n          };\n        });\n      }\n    }\n  };\n}\nvar _excluded$1 = [\"children\", \"fallback\", \"tabIndex\", \"resize\", \"id\", \"style\", \"className\", \"events\"];\n// React currently throws a warning when using useLayoutEffect on the server.\n// To get around it, we can conditionally useEffect on the server (no-op) and\n// useLayoutEffect in the browser.\nvar useIsomorphicLayoutEffect = typeof window !== 'undefined' ? React.useLayoutEffect : React.useEffect;\nfunction Block(_ref) {\n  var set = _ref.set;\n  useIsomorphicLayoutEffect(function () {\n    set(new Promise(function () {\n      return null;\n    }));\n    return function () {\n      return set(false);\n    };\n  }, []);\n  return null;\n}\nvar ErrorBoundary = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(ErrorBoundary, _React$Component);\n  function ErrorBoundary() {\n    var _this;\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.state = {\n      error: false\n    };\n    return _this;\n  }\n  var _proto = ErrorBoundary.prototype;\n  _proto.componentDidCatch = function componentDidCatch(error) {\n    this.props.set(error);\n  };\n  _proto.render = function render() {\n    return this.state.error ? null : this.props.children;\n  };\n  return ErrorBoundary;\n}(React.Component);\nErrorBoundary.getDerivedStateFromError = function () {\n  return {\n    error: true\n  };\n};\nvar Canvas = /*#__PURE__*/React.forwardRef(function Canvas(_ref2, forwardedRef) {\n  var children = _ref2.children,\n    fallback = _ref2.fallback,\n    tabIndex = _ref2.tabIndex,\n    resize = _ref2.resize,\n    id = _ref2.id,\n    style = _ref2.style,\n    className = _ref2.className,\n    events = _ref2.events,\n    props = _objectWithoutPropertiesLoose(_ref2, _excluded$1);\n  var _useMeasure = useMeasure(_extends({\n      scroll: true,\n      debounce: {\n        scroll: 50,\n        resize: 0\n      }\n    }, resize)),\n    containerRef = _useMeasure[0],\n    size = _useMeasure[1];\n  var canvasRef = React.useRef(null);\n  var _React$useState = React.useState(false),\n    block = _React$useState[0],\n    setBlock = _React$useState[1];\n  var _React$useState2 = React.useState(false),\n    error = _React$useState2[0],\n    setError = _React$useState2[1]; // Suspend this component if block is a promise (2nd run)\n\n  if (block) throw block; // Throw exception outwards if anything within canvas throws\n\n  if (error) throw error; // Execute JSX in the reconciler as a layout-effect\n\n  useIsomorphicLayoutEffect(function () {\n    if (size.width > 0 && size.height > 0) {\n      render(/*#__PURE__*/React.createElement(ErrorBoundary, {\n        set: setError\n      }, /*#__PURE__*/React.createElement(React.Suspense, {\n        fallback: /*#__PURE__*/React.createElement(Block, {\n          set: setBlock\n        })\n      }, children)), canvasRef.current, _extends({}, props, {\n        size: size,\n        events: events || createPointerEvents\n      }));\n    }\n  }, [size, children]);\n  useIsomorphicLayoutEffect(function () {\n    var container = canvasRef.current;\n    return function () {\n      return unmountComponentAtNode(container);\n    };\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: containerRef,\n    id: id,\n    className: className,\n    tabIndex: tabIndex,\n    style: _extends({\n      position: 'relative',\n      width: '100%',\n      height: '100%',\n      overflow: 'hidden'\n    }, style)\n  }, /*#__PURE__*/React.createElement(\"canvas\", {\n    ref: mergeRefs([canvasRef, forwardedRef]),\n    style: {\n      display: 'block'\n    }\n  }, fallback));\n});\nfunction useThree(selector, equalityFn) {\n  if (selector === void 0) {\n    selector = function selector(state) {\n      return state;\n    };\n  }\n  var useStore = React.useContext(context);\n  if (!useStore) throw \"R3F hooks can only be used within the Canvas component!\";\n  return useStore(selector, equalityFn);\n}\nfunction useFrame(callback, renderPriority) {\n  if (renderPriority === void 0) {\n    renderPriority = 0;\n  }\n  var subscribe = React.useContext(context).getState().internal.subscribe; // Update ref\n\n  var ref = React.useRef(callback);\n  React.useLayoutEffect(function () {\n    return void (ref.current = callback);\n  }, [callback]); // Subscribe/unsub\n\n  React.useLayoutEffect(function () {\n    var unsubscribe = subscribe(ref, renderPriority);\n    return function () {\n      return unsubscribe();\n    };\n  }, [renderPriority, subscribe]);\n  return null;\n}\nfunction buildGraph(object) {\n  var data = {\n    nodes: {},\n    materials: {}\n  };\n  if (object) {\n    object.traverse(function (obj) {\n      if (obj.name) {\n        data.nodes[obj.name] = obj;\n      }\n      if (obj.material && !data.materials[obj.material.name]) {\n        data.materials[obj.material.name] = obj.material;\n      }\n    });\n  }\n  return data;\n}\nfunction useGraph(object) {\n  return React.useMemo(function () {\n    return buildGraph(object);\n  }, [object]);\n}\nfunction loadingFn(extensions, onProgress) {\n  return function (Proto) {\n    // Construct new loader and run extensions\n    var loader = new Proto();\n    if (extensions) extensions(loader); // Go through the urls and load them\n\n    for (var _len = arguments.length, input = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      input[_key - 1] = arguments[_key];\n    }\n    return Promise.all(input.map(function (input) {\n      return new Promise(function (res, reject) {\n        return loader.load(input, function (data) {\n          if (data.scene) Object.assign(data, buildGraph(data.scene));\n          res(data);\n        }, onProgress, function (error) {\n          return reject(\"Could not load \" + input + \": \" + error.message);\n        });\n      });\n    }));\n  };\n}\nfunction useLoader(Proto, input, extensions, onProgress) {\n  // Use suspense to load async assets\n  var keys = Array.isArray(input) ? input : [input];\n  var results = useAsset.apply(void 0, [loadingFn(extensions, onProgress), Proto].concat(keys)); // Return the object/s\n\n  return Array.isArray(input) ? results : results[0];\n}\nuseLoader.preload = function (Proto, input, extensions) {\n  var keys = Array.isArray(input) ? input : [input];\n  return useAsset.preload.apply(useAsset, [loadingFn(extensions), Proto].concat(keys));\n};\nuseLoader.clear = function (Proto, input) {\n  var keys = Array.isArray(input) ? input : [input];\n  return useAsset.clear.apply(useAsset, [Proto].concat(keys));\n};\nvar _excluded = [\"gl\", \"size\", \"mode\", \"events\", \"onCreated\"];\nvar roots = new Map();\nvar modes = ['legacy', 'blocking', 'concurrent'];\nvar _createLoop = createLoop(roots),\n  invalidate = _createLoop.invalidate,\n  advance = _createLoop.advance;\nvar _createRenderer = createRenderer(),\n  reconciler = _createRenderer.reconciler,\n  applyProps = _createRenderer.applyProps;\nvar createRendererInstance = function createRendererInstance(gl, canvas) {\n  return isRenderer(gl) ? gl : new THREE.WebGLRenderer(_extends({\n    powerPreference: 'high-performance',\n    canvas: canvas,\n    antialias: true,\n    alpha: true\n  }, gl));\n};\nfunction render(element, canvas, _temp) {\n  var _store;\n  var _ref = _temp === void 0 ? {} : _temp,\n    gl = _ref.gl,\n    size = _ref.size,\n    _ref$mode = _ref.mode,\n    mode = _ref$mode === void 0 ? modes[1] : _ref$mode,\n    events = _ref.events,\n    onCreated = _ref.onCreated,\n    props = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  // Allow size to take on container bounds initially\n  if (!size) {\n    var _canvas$parentElement, _canvas$parentElement2, _canvas$parentElement3, _canvas$parentElement4;\n    size = {\n      width: (_canvas$parentElement = (_canvas$parentElement2 = canvas.parentElement) == null ? void 0 : _canvas$parentElement2.clientWidth) != null ? _canvas$parentElement : 0,\n      height: (_canvas$parentElement3 = (_canvas$parentElement4 = canvas.parentElement) == null ? void 0 : _canvas$parentElement4.clientHeight) != null ? _canvas$parentElement3 : 0\n    };\n  }\n  var root = roots.get(canvas);\n  var fiber = root == null ? void 0 : root.fiber;\n  var store = root == null ? void 0 : root.store;\n  var state = (_store = store) == null ? void 0 : _store.getState();\n  if (fiber && state) {\n    var lastProps = state.internal.lastProps; // When a root was found, see if any fundamental props must be changed or exchanged\n    // Check pixelratio\n\n    if (props.dpr !== undefined && !is.equ(lastProps.dpr, props.dpr)) state.setDpr(props.dpr); // Check size\n\n    if (!is.equ(lastProps.size, size)) state.setSize(size.width, size.height); // For some props we want to reset the entire root\n    // Changes to the color-space\n\n    var linearChanged = props.linear !== lastProps.linear;\n    if (linearChanged) {\n      unmountComponentAtNode(canvas);\n      fiber = undefined;\n    }\n  }\n  if (!fiber) {\n    // If no root has been found, make one\n    // Create gl\n    var glRenderer = createRendererInstance(gl, canvas); // Enable VR if requested\n\n    if (props.vr) {\n      glRenderer.xr.enabled = true;\n      glRenderer.setAnimationLoop(function (timestamp) {\n        return advance(timestamp, true);\n      });\n    } // Create store\n\n    store = createStore(applyProps, invalidate, advance, _extends({\n      gl: glRenderer,\n      size: size\n    }, props));\n    var _state = store.getState(); // Create renderer\n\n    fiber = reconciler.createContainer(store, modes.indexOf(mode), false, null); // Map it\n\n    roots.set(canvas, {\n      fiber: fiber,\n      store: store\n    }); // Store events internally\n\n    if (events) _state.set({\n      events: events(store)\n    });\n  }\n  if (store && fiber) {\n    reconciler.updateContainer(/*#__PURE__*/React.createElement(Provider, {\n      store: store,\n      element: element,\n      onCreated: onCreated,\n      target: canvas\n    }), fiber, null, function () {\n      return undefined;\n    });\n    return store;\n  } else {\n    throw 'Error creating root!';\n  }\n}\nfunction Provider(_ref2) {\n  var store = _ref2.store,\n    element = _ref2.element,\n    onCreated = _ref2.onCreated,\n    target = _ref2.target;\n  React.useEffect(function () {\n    var state = store.getState(); // Flag the canvas active, rendering will now begin\n\n    state.set(function (state) {\n      return {\n        internal: _extends({}, state.internal, {\n          active: true\n        })\n      };\n    }); // Connect events\n\n    state.events.connect == null ? void 0 : state.events.connect(target); // Notifiy that init is completed, the scene graph exists, but nothing has yet rendered\n\n    if (onCreated) onCreated(state);\n  }, []);\n  return /*#__PURE__*/React.createElement(context.Provider, {\n    value: store\n  }, element);\n}\nfunction unmountComponentAtNode(canvas, callback) {\n  var root = roots.get(canvas);\n  var fiber = root == null ? void 0 : root.fiber;\n  if (fiber) {\n    var _state2 = root == null ? void 0 : root.store.getState();\n    if (_state2) _state2.internal.active = false;\n    reconciler.updateContainer(null, fiber, null, function () {\n      if (_state2) {\n        setTimeout(function () {\n          var _state2$gl, _state2$gl$renderList, _state2$gl2;\n          _state2.events.disconnect == null ? void 0 : _state2.events.disconnect();\n          (_state2$gl = _state2.gl) == null ? void 0 : (_state2$gl$renderList = _state2$gl.renderLists) == null ? void 0 : _state2$gl$renderList.dispose == null ? void 0 : _state2$gl$renderList.dispose();\n          (_state2$gl2 = _state2.gl) == null ? void 0 : _state2$gl2.forceContextLoss == null ? void 0 : _state2$gl2.forceContextLoss();\n          dispose(_state2);\n          roots.delete(canvas);\n          if (callback) callback(canvas);\n        }, 500);\n      }\n    });\n  }\n}\nfunction dispose(obj) {\n  if (obj.dispose && obj.type !== 'Scene') obj.dispose();\n  for (var p in obj) {\n    var _dispose, _ref3;\n    (_dispose = (_ref3 = p).dispose) == null ? void 0 : _dispose.call(_ref3);\n    delete obj[p];\n  }\n}\nvar act = reconciler.act;\nvar hasSymbol = is.fun(Symbol) && Symbol.for;\nvar REACT_PORTAL_TYPE = hasSymbol ? Symbol.for('react.portal') : 0xeaca;\nfunction createPortal(children, container, implementation, key) {\n  if (key === void 0) {\n    key = null;\n  }\n  return {\n    $$typeof: REACT_PORTAL_TYPE,\n    key: key == null ? null : '' + key,\n    children: children,\n    containerInfo: prepare(container),\n    implementation: implementation\n  };\n}\nreconciler.injectIntoDevTools({\n  bundleType: process.env.NODE_ENV === 'production' ? 0 : 1,\n  rendererPackageName: '@react-three/fiber',\n  version: '17.0.2'\n});\nexport { Canvas, threeTypes as ReactThreeFiber, roots as _roots, act, addAfterEffect, addEffect, addTail, advance, applyProps, context, createPortal, dispose, createPointerEvents as events, extend, invalidate, reconciler, render, unmountComponentAtNode, useFrame, useGraph, useLoader, useThree };","map":{"version":3,"names":["_objectWithoutPropertiesLoose","_extends","THREE","React","create","shallow","_construct","Reconciler","unstable_now","unstable_runWithPriority","unstable_IdlePriority","_createForOfIteratorHelperLoose","useAsset","_inheritsLoose","mergeRefs","useMeasure","threeTypes","Object","freeze","__proto__","is","obj","a","arr","fun","str","num","und","Array","isArray","equ","b","i","makeId","event","eventObject","object","uuid","index","removeInteractivity","store","_store$getState","getState","internal","interaction","filter","o","initialHits","hovered","forEach","value","key","delete","createEvents","temp","Vector3","prepareRay","_raycaster$computeOff","state","raycaster","mouse","camera","size","_ref","computeOffsets","offsetX","offsetY","width","height","set","setFromCamera","calculateDistance","_store$getState2","dx","initialClick","dy","Math","round","sqrt","filterPointerEvents","objects","some","name","_r3f$handlers","__r3f","handlers","intersect","enabled","seen","Set","intersections","eventsObjects","intersects","intersectObjects","item","id","has","add","_iterator","_step","done","_intersect","_r3f","push","parent","patchIntersects","_store$getState3","capturedMap","pointerId","apply","get","values","handleIntersects","callback","_store$getState4","length","unprojectedPoint","x","y","unproject","delta","type","releasePointerCapture","target","localState","stopped","_loop","hit","_step2","hasPointerCapture","_internal$capturedMap","_internal$capturedMap2","setPointerCapture","Map","extractEventProps","prop","getPrototypeOf","property","raycastEvent","spaceX","spaceY","ray","stopPropagation","capturesForPointer","from","find","higher","slice","indexOf","cancelPointer","concat","currentTarget","sourceEvent","nativeEvent","_iterator2","_ret","hits","_store$getState5","hoveredObj","data","onPointerOut","onPointerLeave","handlePointer","_store$getState6","onPointerMissed","isPointerMove","undefined","onPointerOver","onPointerEnter","hoveredItem","onPointerMove","handler","includes","pointerMissed","map","_r3f$handlers2","_excluded$3","_excluded2","_excluded3","isStore","def","getContainer","container","child","_container$__r3f$root","_container$__r3f","root","scene","DEFAULT","EMPTY","FILTER","catalogue","extend","prepare","instance","memoizedProps","createRenderer","roots","applyProps","newProps","oldProps","accumulative","_instance$__r3f","_root$getState","_instance$__r3f2","rootState","sameProps","newMemoizedProps","entries","entry","args","attach","objectKeys","keys","test","leftOvers","hasOwnProperty","toFilter","filteredProps","filteredPropsEntries","unshift","_ref2","currentInstance","targetProp","split","reduce","acc","_entries$reverse","reverse","_name","reverseEntries","constructor","defaultClassCall","dispose","copy","Layers","fromArray","_targetProp","isColor","Color","setScalar","mask","linear","convertSRGBToLinear","Texture","encoding","sRGBEncoding","invalidateInstance","raycast","splice","_extends2","updateInstance","_instance$__r3f3","_instance$__r3f3$root","frames","invalidate","onUpdate","createInstance","_ref3","hostContext","internalInstanceHandle","_ref3$args","props","toUpperCase","fn","node","return","stateNode","containerInfo","isArgsArr","endsWith","appendChild","parentInstance","addedAsChild","attachArray","attachObject","attachFns","_ref4","attachFn","isObject3D","insertBefore","beforeChild","added","array","dispatchEvent","restSiblings","children","sibling","removeRecursive","removeChild","_child$__r3f2","oldLength","newLength","_ref5","detachFn","_child$__r3f","remove","isInstance","shouldDispose","_child$__r3f3","switchInstance","fiber","newInstance","alternate","ref","current","reconciler","now","appendInitialChild","warnsIfNotActing","supportsMutation","isPrimaryRenderer","scheduleTimeout","setTimeout","cancelTimeout","clearTimeout","noTimeout","appendChildToContainer","_getContainer","removeChildFromContainer","_getContainer2","insertInContainerBefore","_getContainer3","commitUpdate","updatePayload","_newProps$args","argsNew","restNew","_oldProps$args","argsOld","restOld","hasNewArgs","_ref6","val","hideInstance","visible","unhideInstance","hideTextInstance","Error","getPublicInstance","getRootHostContext","rootContainer","getChildHostContext","parentHostContext","createTextInstance","finalizeInitialChildren","commitMount","prepareUpdate","shouldDeprioritizeSubtree","prepareForCommit","preparePortalMount","resetAfterCommit","shouldSetTextContent","clearContainer","_excluded$2","isRenderer","render","isOrthographicCamera","context","createContext","createStore","_invalidate","_advance","gl","_props$shadows","shadows","_props$linear","_props$flat","flat","_props$vr","vr","_props$orthographic","orthographic","_props$frameloop","frameloop","_props$dpr","dpr","performance","_props$clock","clock","Clock","raycastOptions","cameraOptions","shadowMap","assign","PCFSoftShadowMap","toneMapping","ACESFilmicToneMapping","outputEncoding","stop","elapsedTime","Raycaster","params","options","isCamera","Camera","OrthographicCamera","PerspectiveCamera","position","z","lookAt","_setDpr","min","max","window","devicePixelRatio","initialDpr","defaultTarget","getCurrentViewport","_size","aspect","distance","getWorldPosition","distanceTo","zoom","factor","fov","PI","h","tan","w","performanceTimeout","setPerformanceCurrent","advance","timestamp","runGlobalEffects","Scene","controls","Vector2","debounce","regress","viewport","setSize","setDpr","events","connected","active","priority","lastProps","subscribers","subscribe","sort","s","_rootState$getState","left","right","top","bottom","updateProjectionMatrix","updateMatrixWorld","setPixelRatio","createSubs","subs","globalEffects","globalAfterEffects","globalTailEffects","addEffect","addAfterEffect","addTail","run","effects","render$1","getDelta","oldTime","createLoop","running","repeat","loop","requestAnimationFrame","createPointerEvents","_createEvents","names","onClick","onContextMenu","onDoubleClick","onWheel","onPointerDown","onPointerUp","onPointerCancel","onLostPointerCapture","connect","_events$handlers","disconnect","_names","eventName","passive","addEventListener","_events$handlers2","HTMLElement","_names2","removeEventListener","_excluded$1","useIsomorphicLayoutEffect","useLayoutEffect","useEffect","Block","Promise","ErrorBoundary","_React$Component","_this","_len","arguments","_key","call","error","_proto","prototype","componentDidCatch","Component","getDerivedStateFromError","Canvas","forwardRef","forwardedRef","fallback","tabIndex","resize","style","className","_useMeasure","scroll","containerRef","canvasRef","useRef","_React$useState","useState","block","setBlock","_React$useState2","setError","createElement","Suspense","unmountComponentAtNode","overflow","display","useThree","selector","equalityFn","useStore","useContext","useFrame","renderPriority","unsubscribe","buildGraph","nodes","materials","traverse","material","useGraph","useMemo","loadingFn","extensions","onProgress","Proto","loader","input","all","res","reject","load","message","useLoader","results","preload","clear","_excluded","modes","_createLoop","_createRenderer","createRendererInstance","canvas","WebGLRenderer","powerPreference","antialias","alpha","element","_temp","_store","_ref$mode","mode","onCreated","_canvas$parentElement","_canvas$parentElement2","_canvas$parentElement3","_canvas$parentElement4","parentElement","clientWidth","clientHeight","linearChanged","glRenderer","xr","setAnimationLoop","_state","createContainer","updateContainer","Provider","_state2","_state2$gl","_state2$gl$renderList","_state2$gl2","renderLists","forceContextLoss","p","_dispose","act","hasSymbol","Symbol","for","REACT_PORTAL_TYPE","createPortal","implementation","$$typeof","injectIntoDevTools","bundleType","process","env","NODE_ENV","rendererPackageName","version","ReactThreeFiber","_roots"],"sources":["C:/Users/admin/Download/project-long/cellphones/client-cellphones/node_modules/@react-three/fiber/dist/react-three-fiber.esm.js"],"sourcesContent":["import _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\nimport _extends from '@babel/runtime/helpers/esm/extends';\nimport * as THREE from 'three';\nimport * as React from 'react';\nimport create from 'zustand';\nimport shallow from 'zustand/shallow';\nimport _construct from '@babel/runtime/helpers/esm/construct';\nimport Reconciler from 'react-reconciler';\nimport { unstable_now, unstable_runWithPriority, unstable_IdlePriority } from 'scheduler';\nimport _createForOfIteratorHelperLoose from '@babel/runtime/helpers/esm/createForOfIteratorHelperLoose';\nimport { useAsset } from 'use-asset';\nimport _inheritsLoose from '@babel/runtime/helpers/esm/inheritsLoose';\nimport mergeRefs from 'react-merge-refs';\nimport useMeasure from 'react-use-measure';\n\nvar threeTypes = /*#__PURE__*/Object.freeze({\n  __proto__: null\n});\n\nvar is = {\n  obj: function obj(a) {\n    return a === Object(a) && !is.arr(a) && typeof a !== 'function';\n  },\n  fun: function fun(a) {\n    return typeof a === 'function';\n  },\n  str: function str(a) {\n    return typeof a === 'string';\n  },\n  num: function num(a) {\n    return typeof a === 'number';\n  },\n  und: function und(a) {\n    return a === void 0;\n  },\n  arr: function arr(a) {\n    return Array.isArray(a);\n  },\n  equ: function equ(a, b) {\n    // Wrong type or one of the two undefined, doesn't match\n    if (typeof a !== typeof b || !!a !== !!b) return false; // Atomic, just compare a against b\n\n    if (is.str(a) || is.num(a) || is.obj(a)) return a === b; // Array, shallow compare first to see if it's a match\n\n    if (is.arr(a) && a == b) return true; // Last resort, go through keys\n\n    var i;\n\n    for (i in a) {\n      if (!(i in b)) return false;\n    }\n\n    for (i in b) {\n      if (a[i] !== b[i]) return false;\n    }\n\n    return is.und(i) ? a === b : true;\n  }\n};\n\nfunction makeId(event) {\n  return (event.eventObject || event.object).uuid + '/' + event.index;\n}\n\nfunction removeInteractivity(store, object) {\n  var _store$getState = store.getState(),\n      internal = _store$getState.internal; // Removes every trace of an object from the data store\n\n\n  internal.interaction = internal.interaction.filter(function (o) {\n    return o !== object;\n  });\n  internal.initialHits = internal.initialHits.filter(function (o) {\n    return o !== object;\n  });\n  internal.hovered.forEach(function (value, key) {\n    if (value.eventObject === object || value.object === object) {\n      internal.hovered.delete(key);\n    }\n  });\n}\nfunction createEvents(store) {\n  var temp = new THREE.Vector3();\n  /** Sets up defaultRaycaster */\n\n  function prepareRay(event) {\n    var _raycaster$computeOff;\n\n    var state = store.getState();\n    var raycaster = state.raycaster,\n        mouse = state.mouse,\n        camera = state.camera,\n        size = state.size; // https://github.com/pmndrs/react-three-fiber/pull/782\n    // Events trigger outside of canvas when moved\n\n    var _ref = (_raycaster$computeOff = raycaster.computeOffsets == null ? void 0 : raycaster.computeOffsets(event, state)) != null ? _raycaster$computeOff : event,\n        offsetX = _ref.offsetX,\n        offsetY = _ref.offsetY;\n\n    var width = size.width,\n        height = size.height;\n    mouse.set(offsetX / width * 2 - 1, -(offsetY / height) * 2 + 1);\n    raycaster.setFromCamera(mouse, camera);\n  }\n  /** Calculates delta */\n\n\n  function calculateDistance(event) {\n    var _store$getState2 = store.getState(),\n        internal = _store$getState2.internal;\n\n    var dx = event.offsetX - internal.initialClick[0];\n    var dy = event.offsetY - internal.initialClick[1];\n    return Math.round(Math.sqrt(dx * dx + dy * dy));\n  }\n  /** Returns true if an instance has a valid pointer-event registered, this excludes scroll, clicks etc */\n\n\n  function filterPointerEvents(objects) {\n    return objects.filter(function (obj) {\n      return ['Move', 'Over', 'Enter', 'Out', 'Leave'].some(function (name) {\n        var _r3f$handlers;\n\n        return (_r3f$handlers = obj.__r3f.handlers) == null ? void 0 : _r3f$handlers['onPointer' + name];\n      });\n    });\n  }\n\n  function intersect(filter) {\n    var state = store.getState();\n    var raycaster = state.raycaster,\n        internal = state.internal; // Skip event handling when noEvents is set\n\n    if (!raycaster.enabled) return [];\n    var seen = new Set();\n    var intersections = []; // Allow callers to eliminate event objects\n\n    var eventsObjects = filter ? filter(internal.interaction) : internal.interaction; // Intersect known handler objects and filter against duplicates\n\n    var intersects = raycaster.intersectObjects(eventsObjects, true).filter(function (item) {\n      var id = makeId(item);\n      if (seen.has(id)) return false;\n      seen.add(id);\n      return true;\n    }); // https://github.com/mrdoob/three.js/issues/16031\n    // Allow custom userland intersect sort order\n\n    if (raycaster.filter) intersects = raycaster.filter(intersects, state);\n\n    for (var _iterator = _createForOfIteratorHelperLoose(intersects), _step; !(_step = _iterator()).done;) {\n      var _intersect = _step.value;\n      var eventObject = _intersect.object; // Bubble event up\n\n      while (eventObject) {\n        var _r3f;\n\n        var handlers = (_r3f = eventObject.__r3f) == null ? void 0 : _r3f.handlers;\n        if (handlers) intersections.push(_extends({}, _intersect, {\n          eventObject: eventObject\n        }));\n        eventObject = eventObject.parent;\n      }\n    }\n\n    return intersections;\n  }\n  /**  Creates filtered intersects and returns an array of positive hits */\n\n\n  function patchIntersects(intersections, event) {\n    var _store$getState3 = store.getState(),\n        internal = _store$getState3.internal; // If the interaction is captured, make all capturing targets  part of the\n    // intersect.\n\n\n    if ('pointerId' in event && internal.capturedMap.has(event.pointerId)) {\n      intersections.push.apply(intersections, internal.capturedMap.get(event.pointerId).values());\n    }\n\n    return intersections;\n  }\n  /**  Handles intersections by forwarding them to handlers */\n\n\n  function handleIntersects(intersections, event, callback) {\n    var _store$getState4 = store.getState(),\n        raycaster = _store$getState4.raycaster,\n        mouse = _store$getState4.mouse,\n        camera = _store$getState4.camera,\n        internal = _store$getState4.internal; // If anything has been found, forward it to the event listeners\n\n\n    if (intersections.length) {\n      (function () {\n        var unprojectedPoint = temp.set(mouse.x, mouse.y, 0).unproject(camera);\n        var delta = event.type === 'click' ? calculateDistance(event) : 0;\n\n        var releasePointerCapture = function releasePointerCapture(id) {\n          return event.target.releasePointerCapture(id);\n        };\n\n        var localState = {\n          stopped: false\n        };\n\n        var _loop = function _loop() {\n          var hit = _step2.value;\n\n          var hasPointerCapture = function hasPointerCapture(id) {\n            var _internal$capturedMap, _internal$capturedMap2;\n\n            return (_internal$capturedMap = (_internal$capturedMap2 = internal.capturedMap.get(id)) == null ? void 0 : _internal$capturedMap2.has(hit.eventObject)) != null ? _internal$capturedMap : false;\n          };\n\n          var setPointerCapture = function setPointerCapture(id) {\n            if (internal.capturedMap.has(id)) {\n              // if the pointerId was previously captured, we add the hit to the\n              // event capturedMap.\n              internal.capturedMap.get(id).set(hit.eventObject, hit);\n            } else {\n              // if the pointerId was not previously captured, we create a map\n              // containing the hitObject, and the hit. hitObject is used for\n              // faster access.\n              internal.capturedMap.set(id, new Map([[hit.eventObject, hit]]));\n            } // Call the original event now\n            event.target.setPointerCapture(id);\n          }; // Add native event props\n\n\n          var extractEventProps = {};\n\n          for (var prop in Object.getPrototypeOf(event)) {\n            var property = event[prop]; // Only copy over atomics, leave functions alone as these should be\n            // called as event.nativeEvent.fn()\n\n            if (typeof property !== 'function') extractEventProps[prop] = property;\n          }\n\n          var raycastEvent = _extends({}, hit, extractEventProps, {\n            spaceX: mouse.x,\n            spaceY: mouse.y,\n            intersections: intersections,\n            stopped: localState.stopped,\n            delta: delta,\n            unprojectedPoint: unprojectedPoint,\n            ray: raycaster.ray,\n            camera: camera,\n            // Hijack stopPropagation, which just sets a flag\n            stopPropagation: function stopPropagation() {\n              // https://github.com/pmndrs/react-three-fiber/issues/596\n              // Events are not allowed to stop propagation if the pointer has been captured\n              var capturesForPointer = 'pointerId' in event && internal.capturedMap.get(event.pointerId); // We only authorize stopPropagation...\n\n              if ( // ...if this pointer hasn't been captured\n              !capturesForPointer || // ... or if the hit object is capturing the pointer\n              capturesForPointer.has(hit.eventObject)) {\n                raycastEvent.stopped = localState.stopped = true; // Propagation is stopped, remove all other hover records\n                // An event handler is only allowed to flush other handlers if it is hovered itself\n\n                if (internal.hovered.size && Array.from(internal.hovered.values()).find(function (i) {\n                  return i.eventObject === hit.eventObject;\n                })) {\n                  // Objects cannot flush out higher up objects that have already caught the event\n                  var higher = intersections.slice(0, intersections.indexOf(hit));\n                  cancelPointer([].concat(higher, [hit]));\n                }\n              }\n            },\n            // there should be a distinction between target and currentTarget\n            target: {\n              hasPointerCapture: hasPointerCapture,\n              setPointerCapture: setPointerCapture,\n              releasePointerCapture: releasePointerCapture\n            },\n            currentTarget: {\n              hasPointerCapture: hasPointerCapture,\n              setPointerCapture: setPointerCapture,\n              releasePointerCapture: releasePointerCapture\n            },\n            sourceEvent: event,\n            // deprecated\n            nativeEvent: event\n          }); // Call subscribers\n\n\n          callback(raycastEvent); // Event bubbling may be interrupted by stopPropagation\n\n          if (localState.stopped === true) return \"break\";\n        };\n\n        for (var _iterator2 = _createForOfIteratorHelperLoose(intersections), _step2; !(_step2 = _iterator2()).done;) {\n          var _ret = _loop();\n\n          if (_ret === \"break\") break;\n        }\n      })();\n    }\n\n    return intersections;\n  }\n\n  function cancelPointer(hits) {\n    var _store$getState5 = store.getState(),\n        internal = _store$getState5.internal;\n\n    Array.from(internal.hovered.values()).forEach(function (hoveredObj) {\n      // When no objects were hit or the the hovered object wasn't found underneath the cursor\n      // we call onPointerOut and delete the object from the hovered-elements map\n      if (!hits.length || !hits.find(function (hit) {\n        return hit.object === hoveredObj.object && hit.index === hoveredObj.index;\n      })) {\n        var eventObject = hoveredObj.eventObject;\n        var handlers = eventObject.__r3f.handlers;\n        internal.hovered.delete(makeId(hoveredObj));\n\n        if (handlers) {\n          // Clear out intersects, they are outdated by now\n          var data = _extends({}, hoveredObj, {\n            intersections: hits || []\n          });\n\n          handlers.onPointerOut == null ? void 0 : handlers.onPointerOut(data);\n          handlers.onPointerLeave == null ? void 0 : handlers.onPointerLeave(data);\n        }\n      }\n    });\n  }\n\n  var handlePointer = function handlePointer(name) {\n    // Deal with cancelation\n    switch (name) {\n      case 'onPointerLeave':\n      case 'onPointerCancel':\n        return function () {\n          return cancelPointer([]);\n        };\n\n      case 'onLostPointerCapture':\n        return function (event) {\n          if ('pointerId' in event) {\n            // this will be a problem if one target releases the pointerId\n            // and another one is still keeping it, as the line below\n            // indifferently deletes all capturing references.\n            store.getState().internal.capturedMap.delete(event.pointerId);\n          }\n\n          cancelPointer([]);\n        };\n    } // Any other pointer goes here ...\n\n\n    return function (event) {\n      var _store$getState6 = store.getState(),\n          onPointerMissed = _store$getState6.onPointerMissed,\n          internal = _store$getState6.internal;\n\n      prepareRay(event); // Get fresh intersects\n\n      var isPointerMove = name === 'onPointerMove';\n      var filter = isPointerMove ? filterPointerEvents : undefined;\n      var hits = patchIntersects(intersect(filter), event); // Take care of unhover\n\n      if (isPointerMove) cancelPointer(hits);\n      handleIntersects(hits, event, function (data) {\n        var eventObject = data.eventObject;\n        var handlers = eventObject.__r3f.handlers; // Check presence of handlers\n\n        if (!handlers) return;\n\n        if (isPointerMove) {\n          // Move event ...\n          if (handlers.onPointerOver || handlers.onPointerEnter || handlers.onPointerOut || handlers.onPointerLeave) {\n            // When enter or out is present take care of hover-state\n            var id = makeId(data);\n            var hoveredItem = internal.hovered.get(id);\n\n            if (!hoveredItem) {\n              // If the object wasn't previously hovered, book it and call its handler\n              internal.hovered.set(id, data);\n              handlers.onPointerOver == null ? void 0 : handlers.onPointerOver(data);\n              handlers.onPointerEnter == null ? void 0 : handlers.onPointerEnter(data);\n            } else if (hoveredItem.stopped) {\n              // If the object was previously hovered and stopped, we shouldn't allow other items to proceed\n              data.stopPropagation();\n            }\n          } // Call mouse move\n\n\n          handlers.onPointerMove == null ? void 0 : handlers.onPointerMove(data);\n        } else {\n          // All other events ...\n          var handler = handlers == null ? void 0 : handlers[name];\n\n          if (handler) {\n            // Forward all events back to their respective handlers with the exception of click events,\n            // which must use the initial target\n            if (name !== 'onClick' && name !== 'onContextMenu' && name !== 'onDoubleClick' || internal.initialHits.includes(eventObject)) {\n              handler(data);\n              pointerMissed(event, internal.interaction.filter(function (object) {\n                return object !== eventObject;\n              }));\n            }\n          }\n        }\n      }); // Save initial coordinates on pointer-down\n\n      if (name === 'onPointerDown') {\n        internal.initialClick = [event.offsetX, event.offsetY];\n        internal.initialHits = hits.map(function (hit) {\n          return hit.eventObject;\n        });\n      } // If a click yields no results, pass it back to the user as a miss\n\n\n      if ((name === 'onClick' || name === 'onContextMenu' || name === 'onDoubleClick') && !hits.length) {\n        if (calculateDistance(event) <= 2) {\n          pointerMissed(event, internal.interaction);\n          if (onPointerMissed) onPointerMissed(event);\n        }\n      }\n    };\n  };\n\n  function pointerMissed(event, objects) {\n    objects.forEach(function (object) {\n      var _r3f$handlers2;\n\n      return (_r3f$handlers2 = object.__r3f.handlers) == null ? void 0 : _r3f$handlers2.onPointerMissed == null ? void 0 : _r3f$handlers2.onPointerMissed(event);\n    });\n  }\n\n  return {\n    handlePointer: handlePointer\n  };\n}\n\nvar _excluded$3 = [\"args\"],\n    _excluded2 = [\"args\"],\n    _excluded3 = [\"args\"];\n\n// Type guard to tell a store from a portal\nvar isStore = function isStore(def) {\n  return def && !!def.getState;\n};\n\nvar getContainer = function getContainer(container, child) {\n  var _container$__r3f$root, _container$__r3f;\n\n  return {\n    // If the container is not a root-store then it must be a THREE.Object3D into which part of the\n    // scene is portalled into. Now there can be two variants of this, either that object is part of\n    // the regular jsx tree, in which case it already has __r3f with a valid root attached, or it lies\n    // outside react, in which case we must take the root of the child that is about to be attached to it.\n    root: isStore(container) ? container : (_container$__r3f$root = (_container$__r3f = container.__r3f) == null ? void 0 : _container$__r3f.root) != null ? _container$__r3f$root : child.__r3f.root,\n    // The container is the eventual target into which objects are mounted, it has to be a THREE.Object3D\n    container: isStore(container) ? container.getState().scene : container\n  };\n};\n\nvar DEFAULT = '__default';\nvar EMPTY = {};\nvar FILTER = ['children', 'key', 'ref'];\nvar catalogue = {};\n\nvar extend = function extend(objects) {\n  return void (catalogue = _extends({}, catalogue, objects));\n}; // Each object in the scene carries a small LocalState descriptor\n\n\nfunction prepare(object, state) {\n  var instance = object;\n\n  if (state != null && state.instance || !instance.__r3f) {\n    instance.__r3f = _extends({\n      root: null,\n      memoizedProps: {},\n      objects: []\n    }, state);\n  }\n\n  return object;\n}\n\nfunction createRenderer(roots) {\n  function applyProps(instance, newProps, oldProps, accumulative) {\n    var _instance$__r3f, _root$getState, _instance$__r3f2;\n\n    if (oldProps === void 0) {\n      oldProps = {};\n    }\n\n    if (accumulative === void 0) {\n      accumulative = false;\n    }\n\n    // Filter equals, events and reserved props\n    var localState = (_instance$__r3f = instance == null ? void 0 : instance.__r3f) != null ? _instance$__r3f : {};\n    var root = localState.root;\n    var rootState = (_root$getState = root == null ? void 0 : root.getState == null ? void 0 : root.getState()) != null ? _root$getState : {};\n    var sameProps = [];\n    var handlers = [];\n    var newMemoizedProps = {};\n    var i = 0;\n    Object.entries(newProps).forEach(function (_ref) {\n      var key = _ref[0],\n          entry = _ref[1];\n\n      // we don't want children, ref or key in the memoized props\n      if (FILTER.indexOf(key) === -1) {\n        newMemoizedProps[key] = entry;\n      }\n    });\n\n    if (localState.memoizedProps && localState.memoizedProps.args) {\n      newMemoizedProps.args = localState.memoizedProps.args;\n    }\n\n    if (localState.memoizedProps && localState.memoizedProps.attach) {\n      newMemoizedProps.attach = localState.memoizedProps.attach;\n    }\n\n    if (instance.__r3f) {\n      instance.__r3f.memoizedProps = newMemoizedProps;\n    }\n\n    var objectKeys = Object.keys(newProps);\n\n    for (i = 0; i < objectKeys.length; i++) {\n      if (is.equ(newProps[objectKeys[i]], oldProps[objectKeys[i]])) {\n        sameProps.push(objectKeys[i]);\n      } // Event-handlers ...\n      //   are functions, that\n      //   start with \"on\", and\n      //   contain the name \"Pointer\", \"Click\", \"DoubleClick\", \"ContextMenu\", or \"Wheel\"\n\n\n      if (is.fun(newProps[objectKeys[i]]) && /^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(objectKeys[i])) {\n        handlers.push(objectKeys[i]);\n      }\n    } // Catch props that existed, but now exist no more ...\n\n\n    var leftOvers = [];\n\n    if (accumulative) {\n      objectKeys = Object.keys(oldProps);\n\n      for (i = 0; i < objectKeys.length; i++) {\n        if (!newProps.hasOwnProperty(objectKeys[i])) {\n          leftOvers.push(objectKeys[i]);\n        }\n      }\n    }\n\n    var toFilter = [].concat(sameProps, FILTER); // Instances use \"object\" as a reserved identifier\n\n    if ((_instance$__r3f2 = instance.__r3f) != null && _instance$__r3f2.instance) toFilter.push('object');\n\n    var filteredProps = _extends({}, newProps); // Removes sameProps and reserved props from newProps\n\n\n    objectKeys = Object.keys(filteredProps);\n\n    for (i = 0; i < objectKeys.length; i++) {\n      if (toFilter.indexOf(objectKeys[i]) > -1) {\n        delete filteredProps[objectKeys[i]];\n      }\n    } // Collect all new props\n\n\n    var filteredPropsEntries = Object.entries(filteredProps); // Prepend left-overs so they can be reset or removed\n    // Left-overs must come first!\n\n    for (i = 0; i < leftOvers.length; i++) {\n      if (leftOvers[i] !== 'children') {\n        filteredPropsEntries.unshift([leftOvers[i], DEFAULT + 'remove']);\n      }\n    }\n\n    if (filteredPropsEntries.length > 0) {\n      filteredPropsEntries.forEach(function (_ref2) {\n        var key = _ref2[0],\n            value = _ref2[1];\n\n        if (!handlers.includes(key)) {\n          var currentInstance = instance;\n          var targetProp = currentInstance[key];\n\n          if (key.includes('-')) {\n            var entries = key.split('-');\n            targetProp = entries.reduce(function (acc, key) {\n              return acc[key];\n            }, instance); // If the target is atomic, it forces us to switch the root\n\n            if (!(targetProp && targetProp.set)) {\n              var _entries$reverse = entries.reverse(),\n                  _name = _entries$reverse[0],\n                  reverseEntries = _entries$reverse.slice(1);\n\n              currentInstance = reverseEntries.reverse().reduce(function (acc, key) {\n                return acc[key];\n              }, instance);\n              key = _name;\n            }\n          } // https://github.com/mrdoob/three.js/issues/21209\n          // HMR/fast-refresh relies on the ability to cancel out props, but threejs\n          // has no means to do this. Hence we curate a small collection of value-classes\n          // with their respective constructor/set arguments\n          // For removed props, try to set default values, if possible\n\n\n          if (value === DEFAULT + 'remove') {\n            if (targetProp && targetProp.constructor) {\n              // use the prop constructor to find the default it should be\n              value = new targetProp.constructor(newMemoizedProps.args);\n            } else if (currentInstance.constructor) {\n              // create a blank slate of the instance and copy the particular parameter.\n              // @ts-ignore\n              var defaultClassCall = new currentInstance.constructor(currentInstance.__r3f.memoizedProps.args);\n              value = defaultClassCall[targetProp]; // destory the instance\n\n              if (defaultClassCall.dispose) {\n                defaultClassCall.dispose();\n              }\n            } else {\n              // instance does not have constructor, just set it to 0\n              value = 0;\n            }\n          } // Special treatment for objects with support for set/copy, and layers\n\n\n          if (targetProp && targetProp.set && (targetProp.copy || targetProp instanceof THREE.Layers)) {\n            // If value is an array\n            if (Array.isArray(value)) {\n              if (targetProp.fromArray) {\n                targetProp.fromArray(value);\n              } else {\n                var _targetProp;\n\n                (_targetProp = targetProp).set.apply(_targetProp, value);\n              }\n            } // Test again target.copy(class) next ...\n            else if (targetProp.copy && value && value.constructor && targetProp.constructor.name === value.constructor.name) {\n                targetProp.copy(value);\n              } // If nothing else fits, just set the single value, ignore undefined\n              // https://github.com/react-spring/react-three-fiber/issues/274\n              else if (value !== undefined) {\n                  var isColor = targetProp instanceof THREE.Color; // Allow setting array scalars\n\n                  if (!isColor && targetProp.setScalar) targetProp.setScalar(value); // Layers have no copy function, we must therefore copy the mask property\n                  else if (targetProp instanceof THREE.Layers && value instanceof THREE.Layers) targetProp.mask = value.mask; // Otherwise just set ...\n                    else targetProp.set(value); // Auto-convert sRGB colors, for now ...\n                  // https://github.com/react-spring/react-three-fiber/issues/344\n\n                  if (!rootState.linear && isColor) targetProp.convertSRGBToLinear();\n                } // Else, just overwrite the value\n\n          } else {\n            currentInstance[key] = value; // Auto-convert sRGB textures, for now ...\n            // https://github.com/react-spring/react-three-fiber/issues/344\n\n            if (!rootState.linear && currentInstance[key] instanceof THREE.Texture) currentInstance[key].encoding = THREE.sRGBEncoding;\n          }\n\n          invalidateInstance(instance);\n        }\n      }); // Preemptively delete the instance from the containers interaction\n\n      if (accumulative && root && instance.raycast && localState.handlers) {\n        localState.handlers = undefined;\n        var index = rootState.internal.interaction.indexOf(instance);\n        if (index > -1) rootState.internal.interaction.splice(index, 1);\n      } // Prep interaction handlers\n\n\n      if (handlers.length) {\n        if (accumulative && root && instance.raycast) {\n          rootState.internal.interaction.push(instance);\n        } // Add handlers to the instances handler-map\n\n\n        localState.handlers = handlers.reduce(function (acc, key) {\n          var _extends2;\n\n          return _extends({}, acc, (_extends2 = {}, _extends2[key] = newProps[key], _extends2));\n        }, {});\n      } // Call the update lifecycle when it is being updated, but only when it is part of the scene\n\n\n      if (instance.parent) updateInstance(instance);\n    }\n  }\n\n  function invalidateInstance(instance) {\n    var _instance$__r3f3, _instance$__r3f3$root;\n\n    var state = (_instance$__r3f3 = instance.__r3f) == null ? void 0 : (_instance$__r3f3$root = _instance$__r3f3.root) == null ? void 0 : _instance$__r3f3$root.getState == null ? void 0 : _instance$__r3f3$root.getState();\n    if (state && state.internal.frames === 0) state.invalidate();\n  }\n\n  function updateInstance(instance) {\n    instance.onUpdate == null ? void 0 : instance.onUpdate(instance);\n  }\n\n  function createInstance(type, _ref3, root, hostContext, internalInstanceHandle) {\n    var _ref3$args = _ref3.args,\n        args = _ref3$args === void 0 ? [] : _ref3$args,\n        props = _objectWithoutPropertiesLoose(_ref3, _excluded$3);\n\n    var name = \"\" + type[0].toUpperCase() + type.slice(1);\n    var instance; // https://github.com/facebook/react/issues/17147\n    // Portals do not give us a root, they are themselves treated as a root by the reconciler\n    // In order to figure out the actual root we have to climb through fiber internals :(\n\n    if (!isStore(root) && internalInstanceHandle) {\n      var fn = function fn(node) {\n        if (!node.return) return node.stateNode && node.stateNode.containerInfo;else return fn(node.return);\n      };\n\n      root = fn(internalInstanceHandle);\n    } // Assert that by now we have a valid root\n\n\n    if (!root || !isStore(root)) throw \"No valid root for \" + name + \"!\";\n\n    if (type === 'primitive') {\n      if (props.object === undefined) throw \"Primitives without 'object' are invalid!\";\n      var object = props.object;\n      instance = prepare(object, {\n        root: root,\n        instance: true\n      });\n    } else {\n      var target = catalogue[name] || THREE[name];\n      if (!target) throw name + \" is not part of the THREE namespace! Did you forget to extend? See: https://github.com/pmndrs/react-three-fiber/blob/master/markdown/api.md#using-3rd-party-objects-declaratively\";\n      var isArgsArr = is.arr(args); // Instanciate new object, link it to the root\n\n      instance = prepare(isArgsArr ? _construct(target, args) : new target(args), {\n        root: root,\n        // append memoized props with args so it's not forgotten\n        memoizedProps: {\n          args: isArgsArr && args.length === 0 ? null : args\n        }\n      });\n    } // Auto-attach geometries and materials\n\n\n    if (!('attachFns' in props)) {\n      if (name.endsWith('Geometry')) {\n        props = _extends({\n          attach: 'geometry'\n        }, props);\n      } else if (name.endsWith('Material')) {\n        props = _extends({\n          attach: 'material'\n        }, props);\n      }\n    } // It should NOT call onUpdate on object instanciation, because it hasn't been added to the\n    // view yet. If the callback relies on references for instance, they won't be ready yet, this is\n    // why it passes \"true\" here\n\n\n    applyProps(instance, props, {});\n    return instance;\n  }\n\n  function appendChild(parentInstance, child) {\n    var addedAsChild = false;\n\n    if (child) {\n      // The attach attribute implies that the object attaches itself on the parent\n      if (child.attachArray) {\n        if (!is.arr(parentInstance[child.attachArray])) parentInstance[child.attachArray] = [];\n        parentInstance[child.attachArray].push(child);\n      } else if (child.attachObject) {\n        if (!is.obj(parentInstance[child.attachObject[0]])) parentInstance[child.attachObject[0]] = {};\n        parentInstance[child.attachObject[0]][child.attachObject[1]] = child;\n      } else if (child.attach && !is.fun(child.attach)) {\n        parentInstance[child.attach] = child;\n      } else if (is.arr(child.attachFns)) {\n        var _ref4 = child.attachFns,\n            attachFn = _ref4[0];\n\n        if (is.str(attachFn) && is.fun(parentInstance[attachFn])) {\n          parentInstance[attachFn](child);\n        } else if (is.fun(attachFn)) {\n          attachFn(child, parentInstance);\n        }\n      } else if (child.isObject3D) {\n        // add in the usual parent-child way\n        parentInstance.add(child);\n        addedAsChild = true;\n      }\n\n      if (!addedAsChild) {\n        // This is for anything that used attach, and for non-Object3Ds that don't get attached to props;\n        // that is, anything that's a child in React but not a child in the scenegraph.\n        parentInstance.__r3f.objects.push(child);\n\n        child.parent = parentInstance;\n      }\n\n      updateInstance(child);\n      invalidateInstance(child);\n    }\n  }\n\n  function insertBefore(parentInstance, child, beforeChild) {\n    var added = false;\n\n    if (child) {\n      if (child.attachArray) {\n        var array = parentInstance[child.attachArray];\n        if (!is.arr(array)) parentInstance[child.attachArray] = [];\n        array.splice(array.indexOf(beforeChild), 0, child);\n      } else if (child.attachObject || child.attach && !is.fun(child.attach)) {\n        // attach and attachObject don't have an order anyway, so just append\n        return appendChild(parentInstance, child);\n      } else if (child.isObject3D) {\n        child.parent = parentInstance;\n        child.dispatchEvent({\n          type: 'added'\n        });\n        var restSiblings = parentInstance.children.filter(function (sibling) {\n          return sibling !== child;\n        });\n        var index = restSiblings.indexOf(beforeChild);\n        parentInstance.children = [].concat(restSiblings.slice(0, index), [child], restSiblings.slice(index));\n        added = true;\n      }\n\n      if (!added) {\n        parentInstance.__r3f.objects.push(child);\n\n        child.parent = parentInstance;\n      }\n\n      updateInstance(child);\n      invalidateInstance(child);\n    }\n  }\n\n  function removeRecursive(array, parent, dispose) {\n    if (dispose === void 0) {\n      dispose = false;\n    }\n\n    if (array) [].concat(array).forEach(function (child) {\n      return removeChild(parent, child, dispose);\n    });\n  }\n\n  function removeChild(parentInstance, child, dispose) {\n    if (child) {\n      var _child$__r3f2;\n\n      if (parentInstance.__r3f.objects) {\n        var oldLength = parentInstance.__r3f.objects.length;\n        parentInstance.__r3f.objects = parentInstance.__r3f.objects.filter(function (x) {\n          return x !== child;\n        });\n        var newLength = parentInstance.__r3f.objects.length; // was it in the list?\n\n        if (newLength < oldLength) {\n          // we had also set this, so we must clear it now\n          child.parent = null;\n        }\n      } // Remove attachment\n\n\n      if (child.attachArray) {\n        parentInstance[child.attachArray] = parentInstance[child.attachArray].filter(function (x) {\n          return x !== child;\n        });\n      } else if (child.attachObject) {\n        delete parentInstance[child.attachObject[0]][child.attachObject[1]];\n      } else if (child.attach && !is.fun(child.attach)) {\n        parentInstance[child.attach] = null;\n      } else if (is.arr(child.attachFns)) {\n        var _ref5 = child.attachFns,\n            detachFn = _ref5[1];\n\n        if (is.str(detachFn) && is.fun(parentInstance[detachFn])) {\n          parentInstance[detachFn](child);\n        } else if (is.fun(detachFn)) {\n          detachFn(child, parentInstance);\n        }\n      } else if (child.isObject3D) {\n        var _child$__r3f;\n\n        parentInstance.remove(child); // Remove interactivity\n\n        if ((_child$__r3f = child.__r3f) != null && _child$__r3f.root) {\n          removeInteractivity(child.__r3f.root, child);\n        }\n      } // Allow objects to bail out of recursive dispose alltogether by passing dispose={null}\n      // Never dispose of primitives because their state may be kept outside of React!\n      // In order for an object to be able to dispose it has to have\n      //   - a dispose method,\n      //   - it cannot be an <instance object={...} />\n      //   - it cannot be a THREE.Scene, because three has broken it's own api\n      //\n      // Since disposal is recursive, we can check the optional dispose arg, which will be undefined\n      // when the reconciler calls it, but then carry our own check recursively\n\n\n      var isInstance = (_child$__r3f2 = child.__r3f) == null ? void 0 : _child$__r3f2.instance;\n      var shouldDispose = dispose === undefined ? child.dispose !== null && !isInstance : dispose; // Remove nested child objects. Primitives should not have objects and children that are\n      // attached to them declaratively ...\n\n      if (!isInstance) {\n        var _child$__r3f3;\n\n        removeRecursive((_child$__r3f3 = child.__r3f) == null ? void 0 : _child$__r3f3.objects, child, shouldDispose);\n        removeRecursive(child.children, child, shouldDispose);\n      } // Remove references\n\n\n      if (child.__r3f) {\n        delete child.__r3f.root;\n        delete child.__r3f.objects;\n        delete child.__r3f.handlers;\n        delete child.__r3f.memoizedProps;\n        if (!isInstance) delete child.__r3f;\n      } // Dispose item whenever the reconciler feels like it\n\n\n      if (shouldDispose && child.dispose && child.type !== 'Scene') {\n        unstable_runWithPriority(unstable_IdlePriority, function () {\n          return child.dispose();\n        });\n      }\n\n      invalidateInstance(parentInstance);\n    }\n  }\n\n  function switchInstance(instance, type, newProps, fiber) {\n    var parent = instance.parent;\n    if (!parent) return;\n    var newInstance = createInstance(type, newProps, instance.__r3f.root); // https://github.com/pmndrs/react-three-fiber/issues/1348\n    // When args change the instance has to be re-constructed, which then\n    // forces r3f to re-parent the children and non-scene objects\n\n    if (instance.children) {\n      instance.children.forEach(function (child) {\n        return appendChild(newInstance, child);\n      });\n      instance.children = [];\n    }\n\n    instance.__r3f.objects.forEach(function (child) {\n      return appendChild(newInstance, child);\n    });\n\n    instance.__r3f.objects = [];\n    removeChild(parent, instance);\n    appendChild(parent, newInstance) // This evil hack switches the react-internal fiber node\n    // https://github.com/facebook/react/issues/14983\n    // https://github.com/facebook/react/pull/15021\n    ;\n    [fiber, fiber.alternate].forEach(function (fiber) {\n      if (fiber !== null) {\n        fiber.stateNode = newInstance;\n\n        if (fiber.ref) {\n          if (typeof fiber.ref === 'function') fiber.ref(newInstance);else fiber.ref.current = newInstance;\n        }\n      }\n    });\n  }\n\n  var reconciler = Reconciler({\n    now: unstable_now,\n    createInstance: createInstance,\n    removeChild: removeChild,\n    appendChild: appendChild,\n    appendInitialChild: appendChild,\n    insertBefore: insertBefore,\n    warnsIfNotActing: true,\n    supportsMutation: true,\n    isPrimaryRenderer: false,\n    // @ts-ignore\n    scheduleTimeout: is.fun(setTimeout) ? setTimeout : undefined,\n    // @ts-ignore\n    cancelTimeout: is.fun(clearTimeout) ? clearTimeout : undefined,\n    // @ts-ignore\n    setTimeout: is.fun(setTimeout) ? setTimeout : undefined,\n    // @ts-ignore\n    clearTimeout: is.fun(clearTimeout) ? clearTimeout : undefined,\n    noTimeout: -1,\n    appendChildToContainer: function appendChildToContainer(parentInstance, child) {\n      var _getContainer = getContainer(parentInstance, child),\n          container = _getContainer.container,\n          root = _getContainer.root; // Link current root to the default scene\n\n\n      container.__r3f.root = root;\n      appendChild(container, child);\n    },\n    removeChildFromContainer: function removeChildFromContainer(parentInstance, child) {\n      var _getContainer2 = getContainer(parentInstance, child),\n          container = _getContainer2.container;\n\n      removeChild(container, child);\n    },\n    insertInContainerBefore: function insertInContainerBefore(parentInstance, child, beforeChild) {\n      var _getContainer3 = getContainer(parentInstance, child),\n          container = _getContainer3.container;\n\n      insertBefore(container, child, beforeChild);\n    },\n    commitUpdate: function commitUpdate(instance, updatePayload, type, oldProps, newProps, fiber) {\n      if (instance.__r3f.instance && newProps.object && newProps.object !== instance) {\n        // <instance object={...} /> where the object reference has changed\n        switchInstance(instance, type, newProps, fiber);\n      } else {\n        // This is a data object, let's extract critical information about it\n        var _newProps$args = newProps.args,\n            argsNew = _newProps$args === void 0 ? [] : _newProps$args,\n            restNew = _objectWithoutPropertiesLoose(newProps, _excluded2);\n\n        var _oldProps$args = oldProps.args,\n            argsOld = _oldProps$args === void 0 ? [] : _oldProps$args,\n            restOld = _objectWithoutPropertiesLoose(oldProps, _excluded3); // If it has new props or arguments, then it needs to be re-instanciated\n\n\n        var hasNewArgs = argsNew.some(function (value, index) {\n          return is.obj(value) ? Object.entries(value).some(function (_ref6) {\n            var key = _ref6[0],\n                val = _ref6[1];\n            return val !== argsOld[index][key];\n          }) : value !== argsOld[index];\n        });\n\n        if (hasNewArgs) {\n          // Next we create a new instance and append it again\n          switchInstance(instance, type, newProps, fiber);\n        } else {\n          // Otherwise just overwrite props\n          applyProps(instance, restNew, restOld, true);\n        }\n      }\n    },\n    hideInstance: function hideInstance(instance) {\n      if (instance.isObject3D) {\n        instance.visible = false;\n        invalidateInstance(instance);\n      }\n    },\n    unhideInstance: function unhideInstance(instance, props) {\n      if (instance.isObject3D && props.visible == null || props.visible) {\n        instance.visible = true;\n        invalidateInstance(instance);\n      }\n    },\n    hideTextInstance: function hideTextInstance() {\n      throw new Error('Text is not allowed in the R3F tree.');\n    },\n    getPublicInstance: function getPublicInstance(instance) {\n      // TODO: might fix switchInstance (?)\n      return instance;\n    },\n    getRootHostContext: function getRootHostContext(rootContainer) {\n      return EMPTY;\n    },\n    getChildHostContext: function getChildHostContext(parentHostContext) {\n      return EMPTY;\n    },\n    createTextInstance: function createTextInstance() {},\n    finalizeInitialChildren: function finalizeInitialChildren(instance) {\n      // https://github.com/facebook/react/issues/20271\n      // Returning true will trigger commitMount\n      return !!instance.__r3f.handlers;\n    },\n    commitMount: function commitMount(instance)\n    /*, type, props*/\n    {\n      // https://github.com/facebook/react/issues/20271\n      // This will make sure events are only added once to the central container\n      if (instance.raycast && instance.__r3f.handlers) instance.__r3f.root.getState().internal.interaction.push(instance);\n    },\n    prepareUpdate: function prepareUpdate() {\n      return EMPTY;\n    },\n    shouldDeprioritizeSubtree: function shouldDeprioritizeSubtree() {\n      return false;\n    },\n    prepareForCommit: function prepareForCommit() {\n      return null;\n    },\n    preparePortalMount: function preparePortalMount() {// noop\n    },\n    resetAfterCommit: function resetAfterCommit() {// noop\n    },\n    shouldSetTextContent: function shouldSetTextContent() {\n      return false;\n    },\n    clearContainer: function clearContainer() {\n      return false;\n    }\n  });\n  return {\n    reconciler: reconciler,\n    applyProps: applyProps\n  };\n}\n\nvar _excluded$2 = [\"params\"];\nvar isRenderer = function isRenderer(def) {\n  return def && !!def.render;\n};\nvar isOrthographicCamera = function isOrthographicCamera(def) {\n  return def && def.isOrthographicCamera;\n};\nvar context = /*#__PURE__*/React.createContext(null);\n\nvar createStore = function createStore(applyProps, _invalidate, _advance, props) {\n  var gl = props.gl,\n      size = props.size,\n      _props$shadows = props.shadows,\n      shadows = _props$shadows === void 0 ? false : _props$shadows,\n      _props$linear = props.linear,\n      linear = _props$linear === void 0 ? false : _props$linear,\n      _props$flat = props.flat,\n      flat = _props$flat === void 0 ? false : _props$flat,\n      _props$vr = props.vr,\n      vr = _props$vr === void 0 ? false : _props$vr,\n      _props$orthographic = props.orthographic,\n      orthographic = _props$orthographic === void 0 ? false : _props$orthographic,\n      _props$frameloop = props.frameloop,\n      frameloop = _props$frameloop === void 0 ? 'always' : _props$frameloop,\n      _props$dpr = props.dpr,\n      dpr = _props$dpr === void 0 ? 1 : _props$dpr,\n      performance = props.performance,\n      _props$clock = props.clock,\n      clock = _props$clock === void 0 ? new THREE.Clock() : _props$clock,\n      raycastOptions = props.raycaster,\n      cameraOptions = props.camera,\n      onPointerMissed = props.onPointerMissed; // Set shadowmap\n\n  if (shadows) {\n    gl.shadowMap.enabled = true;\n    if (typeof shadows === 'object') Object.assign(gl.shadowMap, shadows);else gl.shadowMap.type = THREE.PCFSoftShadowMap;\n  } // Set color management\n\n\n  if (!linear) {\n    if (!flat) gl.toneMapping = THREE.ACESFilmicToneMapping;\n    gl.outputEncoding = THREE.sRGBEncoding;\n  } // clock.elapsedTime is updated using advance(timestamp)\n\n\n  if (frameloop === 'never') {\n    clock.stop();\n    clock.elapsedTime = 0;\n  }\n\n  var rootState = create(function (set, get) {\n    // Create custom raycaster\n    var raycaster = new THREE.Raycaster();\n\n    var _ref = raycastOptions || {},\n        params = _ref.params,\n        options = _objectWithoutPropertiesLoose(_ref, _excluded$2);\n\n    applyProps(raycaster, _extends({\n      enabled: true\n    }, options, {\n      params: _extends({}, raycaster.params, params)\n    }), {}); // Create default camera\n\n    var isCamera = cameraOptions instanceof THREE.Camera;\n    var camera = isCamera ? cameraOptions : orthographic ? new THREE.OrthographicCamera(0, 0, 0, 0, 0.1, 1000) : new THREE.PerspectiveCamera(75, 0, 0.1, 1000);\n\n    if (!isCamera) {\n      camera.position.z = 5;\n      if (cameraOptions) applyProps(camera, cameraOptions, {}); // Always look at center by default\n\n      camera.lookAt(0, 0, 0);\n    }\n\n    function _setDpr(dpr) {\n      return Array.isArray(dpr) ? Math.min(Math.max(dpr[0], window.devicePixelRatio), dpr[1]) : dpr;\n    }\n\n    var initialDpr = _setDpr(dpr);\n\n    var position = new THREE.Vector3();\n    var defaultTarget = new THREE.Vector3();\n\n    function getCurrentViewport(camera, target, size) {\n      if (camera === void 0) {\n        camera = get().camera;\n      }\n\n      if (target === void 0) {\n        target = defaultTarget;\n      }\n\n      if (size === void 0) {\n        size = get().size;\n      }\n\n      var _size = size,\n          width = _size.width,\n          height = _size.height;\n      var aspect = width / height;\n      var distance = camera.getWorldPosition(position).distanceTo(target);\n\n      if (isOrthographicCamera(camera)) {\n        return {\n          width: width / camera.zoom,\n          height: height / camera.zoom,\n          factor: 1,\n          distance: distance,\n          aspect: aspect\n        };\n      } else {\n        var fov = camera.fov * Math.PI / 180; // convert vertical fov to radians\n\n        var h = 2 * Math.tan(fov / 2) * distance; // visible height\n\n        var w = h * (width / height);\n        return {\n          width: w,\n          height: h,\n          factor: width / w,\n          distance: distance,\n          aspect: aspect\n        };\n      }\n    }\n\n    var performanceTimeout = undefined;\n\n    var setPerformanceCurrent = function setPerformanceCurrent(current) {\n      return set(function (state) {\n        return {\n          performance: _extends({}, state.performance, {\n            current: current\n          })\n        };\n      });\n    };\n\n    return {\n      gl: gl,\n      set: set,\n      get: get,\n      invalidate: function invalidate() {\n        return _invalidate(get());\n      },\n      advance: function advance(timestamp, runGlobalEffects) {\n        return _advance(timestamp, runGlobalEffects, get());\n      },\n      linear: linear,\n      flat: flat,\n      scene: prepare(new THREE.Scene()),\n      camera: camera,\n      controls: null,\n      raycaster: raycaster,\n      clock: clock,\n      mouse: new THREE.Vector2(),\n      vr: vr,\n      frameloop: frameloop,\n      onPointerMissed: onPointerMissed,\n      performance: _extends({\n        current: 1,\n        min: 0.5,\n        max: 1,\n        debounce: 200\n      }, performance, {\n        regress: function regress() {\n          var state = get(); // Clear timeout\n\n          if (performanceTimeout) clearTimeout(performanceTimeout); // Set lower bound performance\n\n          if (state.performance.current !== state.performance.min) setPerformanceCurrent(state.performance.min); // Go back to upper bound performance after a while unless something regresses meanwhile\n\n          performanceTimeout = setTimeout(function () {\n            return setPerformanceCurrent(get().performance.max);\n          }, state.performance.debounce);\n        }\n      }),\n      size: {\n        width: 0,\n        height: 0\n      },\n      viewport: {\n        initialDpr: initialDpr,\n        dpr: initialDpr,\n        width: 0,\n        height: 0,\n        aspect: 0,\n        distance: 0,\n        factor: 0,\n        getCurrentViewport: getCurrentViewport\n      },\n      setSize: function setSize(width, height) {\n        var size = {\n          width: width,\n          height: height\n        };\n        set(function (state) {\n          return {\n            size: size,\n            viewport: _extends({}, state.viewport, getCurrentViewport(camera, defaultTarget, size))\n          };\n        });\n      },\n      setDpr: function setDpr(dpr) {\n        return set(function (state) {\n          return {\n            viewport: _extends({}, state.viewport, {\n              dpr: _setDpr(dpr)\n            })\n          };\n        });\n      },\n      events: {\n        connected: false\n      },\n      internal: {\n        active: false,\n        priority: 0,\n        frames: 0,\n        lastProps: props,\n        interaction: [],\n        hovered: new Map(),\n        subscribers: [],\n        initialClick: [0, 0],\n        initialHits: [],\n        capturedMap: new Map(),\n        subscribe: function subscribe(ref, priority) {\n          if (priority === void 0) {\n            priority = 0;\n          }\n\n          set(function (_ref2) {\n            var internal = _ref2.internal;\n            return {\n              internal: _extends({}, internal, {\n                // If this subscription was given a priority, it takes rendering into its own hands\n                // For that reason we switch off automatic rendering and increase the manual flag\n                // As long as this flag is positive (there could be multiple render subscription)\n                // ..there can be no internal rendering at all\n                priority: internal.priority + (priority > 0 ? 1 : 0),\n                // Register subscriber and sort layers from lowest to highest, meaning,\n                // highest priority renders last (on top of the other frames)\n                subscribers: [].concat(internal.subscribers, [{\n                  ref: ref,\n                  priority: priority\n                }]).sort(function (a, b) {\n                  return a.priority - b.priority;\n                })\n              })\n            };\n          });\n          return function () {\n            set(function (_ref3) {\n              var internal = _ref3.internal;\n              return {\n                internal: _extends({}, internal, {\n                  // Decrease manual flag if this subscription had a priority\n                  priority: internal.priority - (priority > 0 ? 1 : 0),\n                  // Remove subscriber from list\n                  subscribers: internal.subscribers.filter(function (s) {\n                    return s.ref !== ref;\n                  })\n                })\n              };\n            });\n          };\n        }\n      }\n    };\n  }); // Resize camera and renderer on changes to size and pixelratio\n\n  rootState.subscribe(function () {\n    var _rootState$getState = rootState.getState(),\n        camera = _rootState$getState.camera,\n        size = _rootState$getState.size,\n        viewport = _rootState$getState.viewport,\n        internal = _rootState$getState.internal; // https://github.com/pmndrs/react-three-fiber/issues/92\n    // Do not mess with the camera if it belongs to the user\n\n\n    if (!(internal.lastProps.camera instanceof THREE.Camera)) {\n      if (isOrthographicCamera(camera)) {\n        camera.left = size.width / -2;\n        camera.right = size.width / 2;\n        camera.top = size.height / 2;\n        camera.bottom = size.height / -2;\n      } else {\n        camera.aspect = size.width / size.height;\n      }\n\n      camera.updateProjectionMatrix(); // https://github.com/pmndrs/react-three-fiber/issues/178\n      // Update matrix world since the renderer is a frame late\n\n      camera.updateMatrixWorld();\n    } // Update renderer\n\n\n    gl.setPixelRatio(viewport.dpr);\n    gl.setSize(size.width, size.height);\n  }, function (state) {\n    return [state.viewport.dpr, state.size];\n  }, shallow);\n  var state = rootState.getState(); // Update size\n\n  if (size) state.setSize(size.width, size.height); // Invalidate on any change\n\n  rootState.subscribe(function (state) {\n    return _invalidate(state);\n  }); // Return root state\n\n  return rootState;\n};\n\nfunction createSubs(callback, subs) {\n  var index = subs.length;\n  subs.push(callback);\n  return function () {\n    return void subs.splice(index, 1);\n  };\n}\n\nvar i;\nvar globalEffects = [];\nvar globalAfterEffects = [];\nvar globalTailEffects = [];\nvar addEffect = function addEffect(callback) {\n  return createSubs(callback, globalEffects);\n};\nvar addAfterEffect = function addAfterEffect(callback) {\n  return createSubs(callback, globalAfterEffects);\n};\nvar addTail = function addTail(callback) {\n  return createSubs(callback, globalTailEffects);\n};\n\nfunction run(effects, timestamp) {\n  for (i = 0; i < effects.length; i++) {\n    effects[i](timestamp);\n  }\n}\n\nfunction render$1(timestamp, state) {\n  // Run local effects\n  var delta = state.clock.getDelta(); // In frameloop='never' mode, clock times are updated using the provided timestamp\n\n  if (state.frameloop === 'never' && typeof timestamp === 'number') {\n    delta = timestamp - state.clock.elapsedTime;\n    state.clock.oldTime = state.clock.elapsedTime;\n    state.clock.elapsedTime = timestamp;\n  } // Call subscribers (useFrame)\n\n\n  for (i = 0; i < state.internal.subscribers.length; i++) {\n    state.internal.subscribers[i].ref.current(state, delta);\n  } // Render content\n\n\n  if (!state.internal.priority && state.gl.render) state.gl.render(state.scene, state.camera); // Decrease frame count\n\n  state.internal.frames = Math.max(0, state.internal.frames - 1);\n  return state.frameloop === 'always' ? 1 : state.internal.frames;\n}\n\nfunction createLoop(roots) {\n  var running = false;\n  var repeat;\n\n  function loop(timestamp) {\n    running = true;\n    repeat = 0; // Run effects\n\n    run(globalEffects, timestamp); // Render all roots\n\n    roots.forEach(function (root) {\n      var state = root.store.getState(); // If the frameloop is invalidated, do not run another frame\n\n      if (state.internal.active && (state.frameloop === 'always' || state.internal.frames > 0)) repeat += render$1(timestamp, state);\n    }); // Run after-effects\n\n    run(globalAfterEffects, timestamp); // Keep on looping if anything invalidates the frameloop\n\n    if (repeat > 0) return requestAnimationFrame(loop); // Tail call effects, they are called when rendering stops\n    else run(globalTailEffects, timestamp); // Flag end of operation\n\n    running = false;\n  }\n\n  function invalidate(state) {\n    if (!state) return roots.forEach(function (root) {\n      return invalidate(root.store.getState());\n    });\n    if (state.vr || !state.internal.active || state.frameloop === 'never') return; // Increase frames, do not go higher than 60\n\n    state.internal.frames = Math.min(60, state.internal.frames + 1); // If the render-loop isn't active, start it\n\n    if (!running) {\n      running = true;\n      requestAnimationFrame(loop);\n    }\n  }\n\n  function advance(timestamp, runGlobalEffects, state) {\n    if (runGlobalEffects === void 0) {\n      runGlobalEffects = true;\n    }\n\n    if (runGlobalEffects) run(globalEffects, timestamp);\n    if (!state) roots.forEach(function (root) {\n      return render$1(timestamp, root.store.getState());\n    });else render$1(timestamp, state);\n    if (runGlobalEffects) run(globalAfterEffects, timestamp);\n  }\n\n  return {\n    loop: loop,\n    invalidate: invalidate,\n    advance: advance\n  };\n}\n\nfunction createPointerEvents(store) {\n  var _createEvents = createEvents(store),\n      handlePointer = _createEvents.handlePointer;\n\n  var names = {\n    onClick: ['click', false],\n    onContextMenu: ['contextmenu', false],\n    onDoubleClick: ['dblclick', false],\n    onWheel: ['wheel', true],\n    onPointerDown: ['pointerdown', true],\n    onPointerUp: ['pointerup', true],\n    onPointerLeave: ['pointerleave', true],\n    onPointerMove: ['pointermove', true],\n    onPointerCancel: ['pointercancel', true],\n    onLostPointerCapture: ['lostpointercapture', true]\n  };\n  return {\n    connected: false,\n    handlers: Object.keys(names).reduce(function (acc, key) {\n      var _extends2;\n\n      return _extends({}, acc, (_extends2 = {}, _extends2[key] = handlePointer(key), _extends2));\n    }, {}),\n    connect: function connect(target) {\n      var _events$handlers;\n\n      var _store$getState = store.getState(),\n          set = _store$getState.set,\n          events = _store$getState.events;\n\n      events.disconnect == null ? void 0 : events.disconnect();\n      set(function (state) {\n        return {\n          events: _extends({}, state.events, {\n            connected: target\n          })\n        };\n      });\n      Object.entries((_events$handlers = events == null ? void 0 : events.handlers) != null ? _events$handlers : []).forEach(function (_ref) {\n        var name = _ref[0],\n            event = _ref[1];\n        var _names = names[name],\n            eventName = _names[0],\n            passive = _names[1];\n        target.addEventListener(eventName, event, {\n          passive: passive\n        });\n      });\n    },\n    disconnect: function disconnect() {\n      var _store$getState2 = store.getState(),\n          set = _store$getState2.set,\n          events = _store$getState2.events;\n\n      if (events.connected) {\n        var _events$handlers2;\n\n        Object.entries((_events$handlers2 = events.handlers) != null ? _events$handlers2 : []).forEach(function (_ref2) {\n          var name = _ref2[0],\n              event = _ref2[1];\n\n          if (events && events.connected instanceof HTMLElement) {\n            var _names2 = names[name],\n                eventName = _names2[0];\n            events.connected.removeEventListener(eventName, event);\n          }\n        });\n        set(function (state) {\n          return {\n            events: _extends({}, state.events, {\n              connected: false\n            })\n          };\n        });\n      }\n    }\n  };\n}\n\nvar _excluded$1 = [\"children\", \"fallback\", \"tabIndex\", \"resize\", \"id\", \"style\", \"className\", \"events\"];\n// React currently throws a warning when using useLayoutEffect on the server.\n// To get around it, we can conditionally useEffect on the server (no-op) and\n// useLayoutEffect in the browser.\nvar useIsomorphicLayoutEffect = typeof window !== 'undefined' ? React.useLayoutEffect : React.useEffect;\n\nfunction Block(_ref) {\n  var set = _ref.set;\n  useIsomorphicLayoutEffect(function () {\n    set(new Promise(function () {\n      return null;\n    }));\n    return function () {\n      return set(false);\n    };\n  }, []);\n  return null;\n}\n\nvar ErrorBoundary = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(ErrorBoundary, _React$Component);\n\n  function ErrorBoundary() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.state = {\n      error: false\n    };\n    return _this;\n  }\n\n  var _proto = ErrorBoundary.prototype;\n\n  _proto.componentDidCatch = function componentDidCatch(error) {\n    this.props.set(error);\n  };\n\n  _proto.render = function render() {\n    return this.state.error ? null : this.props.children;\n  };\n\n  return ErrorBoundary;\n}(React.Component);\n\nErrorBoundary.getDerivedStateFromError = function () {\n  return {\n    error: true\n  };\n};\n\nvar Canvas = /*#__PURE__*/React.forwardRef(function Canvas(_ref2, forwardedRef) {\n  var children = _ref2.children,\n      fallback = _ref2.fallback,\n      tabIndex = _ref2.tabIndex,\n      resize = _ref2.resize,\n      id = _ref2.id,\n      style = _ref2.style,\n      className = _ref2.className,\n      events = _ref2.events,\n      props = _objectWithoutPropertiesLoose(_ref2, _excluded$1);\n\n  var _useMeasure = useMeasure(_extends({\n    scroll: true,\n    debounce: {\n      scroll: 50,\n      resize: 0\n    }\n  }, resize)),\n      containerRef = _useMeasure[0],\n      size = _useMeasure[1];\n\n  var canvasRef = React.useRef(null);\n\n  var _React$useState = React.useState(false),\n      block = _React$useState[0],\n      setBlock = _React$useState[1];\n\n  var _React$useState2 = React.useState(false),\n      error = _React$useState2[0],\n      setError = _React$useState2[1]; // Suspend this component if block is a promise (2nd run)\n\n\n  if (block) throw block; // Throw exception outwards if anything within canvas throws\n\n  if (error) throw error; // Execute JSX in the reconciler as a layout-effect\n\n  useIsomorphicLayoutEffect(function () {\n    if (size.width > 0 && size.height > 0) {\n      render( /*#__PURE__*/React.createElement(ErrorBoundary, {\n        set: setError\n      }, /*#__PURE__*/React.createElement(React.Suspense, {\n        fallback: /*#__PURE__*/React.createElement(Block, {\n          set: setBlock\n        })\n      }, children)), canvasRef.current, _extends({}, props, {\n        size: size,\n        events: events || createPointerEvents\n      }));\n    }\n  }, [size, children]);\n  useIsomorphicLayoutEffect(function () {\n    var container = canvasRef.current;\n    return function () {\n      return unmountComponentAtNode(container);\n    };\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: containerRef,\n    id: id,\n    className: className,\n    tabIndex: tabIndex,\n    style: _extends({\n      position: 'relative',\n      width: '100%',\n      height: '100%',\n      overflow: 'hidden'\n    }, style)\n  }, /*#__PURE__*/React.createElement(\"canvas\", {\n    ref: mergeRefs([canvasRef, forwardedRef]),\n    style: {\n      display: 'block'\n    }\n  }, fallback));\n});\n\nfunction useThree(selector, equalityFn) {\n  if (selector === void 0) {\n    selector = function selector(state) {\n      return state;\n    };\n  }\n\n  var useStore = React.useContext(context);\n  if (!useStore) throw \"R3F hooks can only be used within the Canvas component!\";\n  return useStore(selector, equalityFn);\n}\nfunction useFrame(callback, renderPriority) {\n  if (renderPriority === void 0) {\n    renderPriority = 0;\n  }\n\n  var subscribe = React.useContext(context).getState().internal.subscribe; // Update ref\n\n  var ref = React.useRef(callback);\n  React.useLayoutEffect(function () {\n    return void (ref.current = callback);\n  }, [callback]); // Subscribe/unsub\n\n  React.useLayoutEffect(function () {\n    var unsubscribe = subscribe(ref, renderPriority);\n    return function () {\n      return unsubscribe();\n    };\n  }, [renderPriority, subscribe]);\n  return null;\n}\n\nfunction buildGraph(object) {\n  var data = {\n    nodes: {},\n    materials: {}\n  };\n\n  if (object) {\n    object.traverse(function (obj) {\n      if (obj.name) {\n        data.nodes[obj.name] = obj;\n      }\n\n      if (obj.material && !data.materials[obj.material.name]) {\n        data.materials[obj.material.name] = obj.material;\n      }\n    });\n  }\n\n  return data;\n}\n\nfunction useGraph(object) {\n  return React.useMemo(function () {\n    return buildGraph(object);\n  }, [object]);\n}\n\nfunction loadingFn(extensions, onProgress) {\n  return function (Proto) {\n    // Construct new loader and run extensions\n    var loader = new Proto();\n    if (extensions) extensions(loader); // Go through the urls and load them\n\n    for (var _len = arguments.length, input = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      input[_key - 1] = arguments[_key];\n    }\n\n    return Promise.all(input.map(function (input) {\n      return new Promise(function (res, reject) {\n        return loader.load(input, function (data) {\n          if (data.scene) Object.assign(data, buildGraph(data.scene));\n          res(data);\n        }, onProgress, function (error) {\n          return reject(\"Could not load \" + input + \": \" + error.message);\n        });\n      });\n    }));\n  };\n}\n\nfunction useLoader(Proto, input, extensions, onProgress) {\n  // Use suspense to load async assets\n  var keys = Array.isArray(input) ? input : [input];\n  var results = useAsset.apply(void 0, [loadingFn(extensions, onProgress), Proto].concat(keys)); // Return the object/s\n\n  return Array.isArray(input) ? results : results[0];\n}\n\nuseLoader.preload = function (Proto, input, extensions) {\n  var keys = Array.isArray(input) ? input : [input];\n  return useAsset.preload.apply(useAsset, [loadingFn(extensions), Proto].concat(keys));\n};\n\nuseLoader.clear = function (Proto, input) {\n  var keys = Array.isArray(input) ? input : [input];\n  return useAsset.clear.apply(useAsset, [Proto].concat(keys));\n};\n\nvar _excluded = [\"gl\", \"size\", \"mode\", \"events\", \"onCreated\"];\nvar roots = new Map();\nvar modes = ['legacy', 'blocking', 'concurrent'];\n\nvar _createLoop = createLoop(roots),\n    invalidate = _createLoop.invalidate,\n    advance = _createLoop.advance;\n\nvar _createRenderer = createRenderer(),\n    reconciler = _createRenderer.reconciler,\n    applyProps = _createRenderer.applyProps;\n\nvar createRendererInstance = function createRendererInstance(gl, canvas) {\n  return isRenderer(gl) ? gl : new THREE.WebGLRenderer(_extends({\n    powerPreference: 'high-performance',\n    canvas: canvas,\n    antialias: true,\n    alpha: true\n  }, gl));\n};\n\nfunction render(element, canvas, _temp) {\n  var _store;\n\n  var _ref = _temp === void 0 ? {} : _temp,\n      gl = _ref.gl,\n      size = _ref.size,\n      _ref$mode = _ref.mode,\n      mode = _ref$mode === void 0 ? modes[1] : _ref$mode,\n      events = _ref.events,\n      onCreated = _ref.onCreated,\n      props = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  // Allow size to take on container bounds initially\n  if (!size) {\n    var _canvas$parentElement, _canvas$parentElement2, _canvas$parentElement3, _canvas$parentElement4;\n\n    size = {\n      width: (_canvas$parentElement = (_canvas$parentElement2 = canvas.parentElement) == null ? void 0 : _canvas$parentElement2.clientWidth) != null ? _canvas$parentElement : 0,\n      height: (_canvas$parentElement3 = (_canvas$parentElement4 = canvas.parentElement) == null ? void 0 : _canvas$parentElement4.clientHeight) != null ? _canvas$parentElement3 : 0\n    };\n  }\n\n  var root = roots.get(canvas);\n  var fiber = root == null ? void 0 : root.fiber;\n  var store = root == null ? void 0 : root.store;\n  var state = (_store = store) == null ? void 0 : _store.getState();\n\n  if (fiber && state) {\n    var lastProps = state.internal.lastProps; // When a root was found, see if any fundamental props must be changed or exchanged\n    // Check pixelratio\n\n    if (props.dpr !== undefined && !is.equ(lastProps.dpr, props.dpr)) state.setDpr(props.dpr); // Check size\n\n    if (!is.equ(lastProps.size, size)) state.setSize(size.width, size.height); // For some props we want to reset the entire root\n    // Changes to the color-space\n\n    var linearChanged = props.linear !== lastProps.linear;\n\n    if (linearChanged) {\n      unmountComponentAtNode(canvas);\n      fiber = undefined;\n    }\n  }\n\n  if (!fiber) {\n    // If no root has been found, make one\n    // Create gl\n    var glRenderer = createRendererInstance(gl, canvas); // Enable VR if requested\n\n    if (props.vr) {\n      glRenderer.xr.enabled = true;\n      glRenderer.setAnimationLoop(function (timestamp) {\n        return advance(timestamp, true);\n      });\n    } // Create store\n\n\n    store = createStore(applyProps, invalidate, advance, _extends({\n      gl: glRenderer,\n      size: size\n    }, props));\n\n    var _state = store.getState(); // Create renderer\n\n\n    fiber = reconciler.createContainer(store, modes.indexOf(mode), false, null); // Map it\n\n    roots.set(canvas, {\n      fiber: fiber,\n      store: store\n    }); // Store events internally\n\n    if (events) _state.set({\n      events: events(store)\n    });\n  }\n\n  if (store && fiber) {\n    reconciler.updateContainer( /*#__PURE__*/React.createElement(Provider, {\n      store: store,\n      element: element,\n      onCreated: onCreated,\n      target: canvas\n    }), fiber, null, function () {\n      return undefined;\n    });\n    return store;\n  } else {\n    throw 'Error creating root!';\n  }\n}\n\nfunction Provider(_ref2) {\n  var store = _ref2.store,\n      element = _ref2.element,\n      onCreated = _ref2.onCreated,\n      target = _ref2.target;\n  React.useEffect(function () {\n    var state = store.getState(); // Flag the canvas active, rendering will now begin\n\n    state.set(function (state) {\n      return {\n        internal: _extends({}, state.internal, {\n          active: true\n        })\n      };\n    }); // Connect events\n\n    state.events.connect == null ? void 0 : state.events.connect(target); // Notifiy that init is completed, the scene graph exists, but nothing has yet rendered\n\n    if (onCreated) onCreated(state);\n  }, []);\n  return /*#__PURE__*/React.createElement(context.Provider, {\n    value: store\n  }, element);\n}\n\nfunction unmountComponentAtNode(canvas, callback) {\n  var root = roots.get(canvas);\n  var fiber = root == null ? void 0 : root.fiber;\n\n  if (fiber) {\n    var _state2 = root == null ? void 0 : root.store.getState();\n\n    if (_state2) _state2.internal.active = false;\n    reconciler.updateContainer(null, fiber, null, function () {\n      if (_state2) {\n        setTimeout(function () {\n          var _state2$gl, _state2$gl$renderList, _state2$gl2;\n\n          _state2.events.disconnect == null ? void 0 : _state2.events.disconnect();\n          (_state2$gl = _state2.gl) == null ? void 0 : (_state2$gl$renderList = _state2$gl.renderLists) == null ? void 0 : _state2$gl$renderList.dispose == null ? void 0 : _state2$gl$renderList.dispose();\n          (_state2$gl2 = _state2.gl) == null ? void 0 : _state2$gl2.forceContextLoss == null ? void 0 : _state2$gl2.forceContextLoss();\n          dispose(_state2);\n          roots.delete(canvas);\n          if (callback) callback(canvas);\n        }, 500);\n      }\n    });\n  }\n}\n\nfunction dispose(obj) {\n  if (obj.dispose && obj.type !== 'Scene') obj.dispose();\n\n  for (var p in obj) {\n    var _dispose, _ref3;\n    (_dispose = (_ref3 = p).dispose) == null ? void 0 : _dispose.call(_ref3);\n    delete obj[p];\n  }\n}\n\nvar act = reconciler.act;\nvar hasSymbol = is.fun(Symbol) && Symbol.for;\nvar REACT_PORTAL_TYPE = hasSymbol ? Symbol.for('react.portal') : 0xeaca;\n\nfunction createPortal(children, container, implementation, key) {\n  if (key === void 0) {\n    key = null;\n  }\n\n  return {\n    $$typeof: REACT_PORTAL_TYPE,\n    key: key == null ? null : '' + key,\n    children: children,\n    containerInfo: prepare(container),\n    implementation: implementation\n  };\n}\n\nreconciler.injectIntoDevTools({\n  bundleType: process.env.NODE_ENV === 'production' ? 0 : 1,\n  rendererPackageName: '@react-three/fiber',\n  version: '17.0.2'\n});\n\nexport { Canvas, threeTypes as ReactThreeFiber, roots as _roots, act, addAfterEffect, addEffect, addTail, advance, applyProps, context, createPortal, dispose, createPointerEvents as events, extend, invalidate, reconciler, render, unmountComponentAtNode, useFrame, useGraph, useLoader, useThree };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}