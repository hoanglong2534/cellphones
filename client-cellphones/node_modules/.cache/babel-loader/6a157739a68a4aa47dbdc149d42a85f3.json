{"ast":null,"code":"import _objectSpread from\"C:/Users/admin/Download/project-long/cellphones/client-cellphones/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useEffect,useRef,useState}from'react';import{Canvas,useFrame}from'@react-three/fiber';import*as THREE from'three';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function SpinningBox(props){const meshRef=useRef();useFrame((_state,delta)=>{if(meshRef.current){meshRef.current.rotation.x+=delta*0.5;meshRef.current.rotation.y+=delta*0.8;}});return/*#__PURE__*/_jsxs(\"mesh\",_objectSpread(_objectSpread({ref:meshRef},props),{},{children:[/*#__PURE__*/_jsx(\"boxGeometry\",{args:[0.25,0.25,0.25]}),/*#__PURE__*/_jsx(\"meshStandardMaterial\",{color:\"#4CC3D9\"})]}));}export default function R3FXRViewer(){const[gl,setGl]=useState(null);const[arSupported,setArSupported]=useState(false);const[vrSupported,setVrSupported]=useState(false);useEffect(()=>{if(!gl)return;gl.xr.enabled=true;},[gl]);useEffect(()=>{// WebXR feature detection\nlet cancelled=false;async function checkSupport(){try{if(navigator.xr&&navigator.xr.isSessionSupported){const[arOK,vrOK]=await Promise.all([navigator.xr.isSessionSupported('immersive-ar').catch(()=>false),navigator.xr.isSessionSupported('immersive-vr').catch(()=>false)]);if(!cancelled){setArSupported(Boolean(arOK));setVrSupported(Boolean(vrOK));}}}catch(_){}}checkSupport();return()=>{cancelled=true;};},[]);async function enterAR(){if(!gl||!navigator.xr)return;try{const session=await navigator.xr.requestSession('immersive-ar',{requiredFeatures:['local-floor']});await gl.xr.setSession(session);}catch(e){// no-op\n}}async function enterVR(){if(!gl||!navigator.xr)return;try{const session=await navigator.xr.requestSession('immersive-vr',{optionalFeatures:['local-floor']});await gl.xr.setSession(session);}catch(e){// no-op\n}}return/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gap:12},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gap:8,gridTemplateColumns:'1fr 1fr'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:enterAR,disabled:!arSupported||!gl,className:\"btn btn-primary\",children:\"ENTER AR\"}),/*#__PURE__*/_jsx(\"button\",{onClick:enterVR,disabled:!vrSupported||!gl,className:\"btn btn-secondary\",children:\"ENTER VR\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',height:420,borderRadius:12,overflow:'hidden',border:'1px solid #333'},children:/*#__PURE__*/_jsxs(Canvas,{onCreated:_ref=>{let{gl:renderer,scene,camera}=_ref;// Match device pixel ratio for clarity\nrenderer.setPixelRatio(Math.min(window.devicePixelRatio,2));renderer.outputEncoding=THREE.sRGBEncoding;setGl(renderer);// Initial camera position\ncamera.position.set(0,0.25,1.2);},children:[/*#__PURE__*/_jsx(\"ambientLight\",{intensity:0.5}),/*#__PURE__*/_jsx(\"directionalLight\",{position:[1,1,1],intensity:0.8}),/*#__PURE__*/_jsxs(\"mesh\",{rotation:[-Math.PI/2,0,0],position:[0,-0.2,0],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[10,10]}),/*#__PURE__*/_jsx(\"meshStandardMaterial\",{color:\"#222\"})]}),/*#__PURE__*/_jsx(SpinningBox,{position:[0,0,0]})]})}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:14,color:'#888',margin:0},children:\"G\\u1EE3i \\xFD: \\\"ENTER AR\\\" c\\u1EA7n thi\\u1EBFt b\\u1ECB h\\u1ED7 tr\\u1EE3 WebXR (Chrome Android). \\\"ENTER VR\\\" c\\u1EA7n tr\\xECnh duy\\u1EC7t/thi\\u1EBFt b\\u1ECB h\\u1ED7 tr\\u1EE3 VR.\"})]});}","map":{"version":3,"names":["React","useEffect","useRef","useState","Canvas","useFrame","THREE","jsx","_jsx","jsxs","_jsxs","SpinningBox","props","meshRef","_state","delta","current","rotation","x","y","_objectSpread","ref","children","args","color","R3FXRViewer","gl","setGl","arSupported","setArSupported","vrSupported","setVrSupported","xr","enabled","cancelled","checkSupport","navigator","isSessionSupported","arOK","vrOK","Promise","all","catch","Boolean","_","enterAR","session","requestSession","requiredFeatures","setSession","e","enterVR","optionalFeatures","style","display","gap","gridTemplateColumns","onClick","disabled","className","width","height","borderRadius","overflow","border","onCreated","_ref","renderer","scene","camera","setPixelRatio","Math","min","window","devicePixelRatio","outputEncoding","sRGBEncoding","position","set","intensity","PI","fontSize","margin"],"sources":["C:/Users/admin/Download/project-long/cellphones/client-cellphones/src/components/ARViewer/R3FXRViewer.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport { Canvas, useFrame } from '@react-three/fiber';\r\nimport * as THREE from 'three';\r\n\r\nfunction SpinningBox(props) {\r\n    const meshRef = useRef();\r\n    useFrame((_state, delta) => {\r\n        if (meshRef.current) {\r\n            meshRef.current.rotation.x += delta * 0.5;\r\n            meshRef.current.rotation.y += delta * 0.8;\r\n        }\r\n    });\r\n    return (\r\n        <mesh ref={meshRef} {...props}>\r\n            <boxGeometry args={[0.25, 0.25, 0.25]} />\r\n            <meshStandardMaterial color=\"#4CC3D9\" />\r\n        </mesh>\r\n    );\r\n}\r\n\r\nexport default function R3FXRViewer() {\r\n    const [gl, setGl] = useState(null);\r\n    const [arSupported, setArSupported] = useState(false);\r\n    const [vrSupported, setVrSupported] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (!gl) return;\r\n        gl.xr.enabled = true;\r\n    }, [gl]);\r\n\r\n    useEffect(() => {\r\n        // WebXR feature detection\r\n        let cancelled = false;\r\n        async function checkSupport() {\r\n            try {\r\n                if (navigator.xr && navigator.xr.isSessionSupported) {\r\n                    const [arOK, vrOK] = await Promise.all([\r\n                        navigator.xr.isSessionSupported('immersive-ar').catch(() => false),\r\n                        navigator.xr.isSessionSupported('immersive-vr').catch(() => false)\r\n                    ]);\r\n                    if (!cancelled) {\r\n                        setArSupported(Boolean(arOK));\r\n                        setVrSupported(Boolean(vrOK));\r\n                    }\r\n                }\r\n            } catch (_) {}\r\n        }\r\n        checkSupport();\r\n        return () => { cancelled = true; };\r\n    }, []);\r\n\r\n    async function enterAR() {\r\n        if (!gl || !navigator.xr) return;\r\n        try {\r\n            const session = await navigator.xr.requestSession('immersive-ar', {\r\n                requiredFeatures: ['local-floor']\r\n            });\r\n            await gl.xr.setSession(session);\r\n        } catch (e) {\r\n            // no-op\r\n        }\r\n    }\r\n\r\n    async function enterVR() {\r\n        if (!gl || !navigator.xr) return;\r\n        try {\r\n            const session = await navigator.xr.requestSession('immersive-vr', {\r\n                optionalFeatures: ['local-floor']\r\n            });\r\n            await gl.xr.setSession(session);\r\n        } catch (e) {\r\n            // no-op\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div style={{ display: 'grid', gap: 12 }}>\r\n            <div style={{ display: 'grid', gap: 8, gridTemplateColumns: '1fr 1fr' }}>\r\n                <button onClick={enterAR} disabled={!arSupported || !gl} className=\"btn btn-primary\">ENTER AR</button>\r\n                <button onClick={enterVR} disabled={!vrSupported || !gl} className=\"btn btn-secondary\">ENTER VR</button>\r\n            </div>\r\n\r\n            <div style={{ width: '100%', height: 420, borderRadius: 12, overflow: 'hidden', border: '1px solid #333' }}>\r\n                <Canvas onCreated={({ gl: renderer, scene, camera }) => {\r\n                    // Match device pixel ratio for clarity\r\n                    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\r\n                    renderer.outputEncoding = THREE.sRGBEncoding;\r\n                    setGl(renderer);\r\n                    // Initial camera position\r\n                    camera.position.set(0, 0.25, 1.2);\r\n                }}>\r\n                    <ambientLight intensity={0.5} />\r\n                    <directionalLight position={[1, 1, 1]} intensity={0.8} />\r\n\r\n                    {/* Ground (only visible in VR/desktop) */}\r\n                    <mesh rotation={[-Math.PI / 2, 0, 0]} position={[0, -0.2, 0]}>\r\n                        <planeGeometry args={[10, 10]} />\r\n                        <meshStandardMaterial color=\"#222\" />\r\n                    </mesh>\r\n\r\n                    <SpinningBox position={[0, 0, 0]} />\r\n                </Canvas>\r\n            </div>\r\n\r\n            <p style={{ fontSize: 14, color: '#888', margin: 0 }}>\r\n                Gợi ý: \"ENTER AR\" cần thiết bị hỗ trợ WebXR (Chrome Android). \"ENTER VR\" cần trình duyệt/thiết bị hỗ trợ VR.\r\n            </p>\r\n        </div>\r\n    );\r\n}\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}